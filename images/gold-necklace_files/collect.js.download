window.NOIBUJS_CONFIG={"scriptID":"fa877a2cb163621ef9d26a507bc46a9301888495"};!function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=6)}([function(e,t,n){"use strict";(function(e){n.d(t,"l",(function(){return r})),n.d(t,"db",(function(){return i})),n.d(t,"kb",(function(){return o})),n.d(t,"cb",(function(){return a})),n.d(t,"hb",(function(){return s})),n.d(t,"lb",(function(){return c})),n.d(t,"mb",(function(){return u})),n.d(t,"rb",(function(){return l})),n.d(t,"ub",(function(){return d})),n.d(t,"tb",(function(){return p})),n.d(t,"e",(function(){return h})),n.d(t,"Lb",(function(){return f})),n.d(t,"Nb",(function(){return m})),n.d(t,"q",(function(){return v})),n.d(t,"f",(function(){return g})),n.d(t,"c",(function(){return b})),n.d(t,"m",(function(){return y})),n.d(t,"yb",(function(){return w})),n.d(t,"Y",(function(){return S})),n.d(t,"n",(function(){return k})),n.d(t,"k",(function(){return C})),n.d(t,"Rb",(function(){return I})),n.d(t,"Sb",(function(){return T})),n.d(t,"bc",(function(){return E})),n.d(t,"fb",(function(){return _})),n.d(t,"ib",(function(){return x})),n.d(t,"gb",(function(){return N})),n.d(t,"Cb",(function(){return O})),n.d(t,"v",(function(){return M})),n.d(t,"jc",(function(){return L})),n.d(t,"Ib",(function(){return D})),n.d(t,"hc",(function(){return R})),n.d(t,"b",(function(){return P})),n.d(t,"Hb",(function(){return A})),n.d(t,"ec",(function(){return F})),n.d(t,"Kb",(function(){return V})),n.d(t,"xb",(function(){return j})),n.d(t,"cc",(function(){return $})),n.d(t,"Mb",(function(){return z})),n.d(t,"Vb",(function(){return q})),n.d(t,"Eb",(function(){return U})),n.d(t,"Jb",(function(){return B})),n.d(t,"i",(function(){return H})),n.d(t,"h",(function(){return W})),n.d(t,"gc",(function(){return Q})),n.d(t,"r",(function(){return J})),n.d(t,"Z",(function(){return X})),n.d(t,"M",(function(){return Y})),n.d(t,"ac",(function(){return G})),n.d(t,"vb",(function(){return K})),n.d(t,"G",(function(){return Z})),n.d(t,"O",(function(){return ee})),n.d(t,"u",(function(){return te})),n.d(t,"Yb",(function(){return ne})),n.d(t,"Ub",(function(){return re})),n.d(t,"Zb",(function(){return ie})),n.d(t,"F",(function(){return oe})),n.d(t,"J",(function(){return ae})),n.d(t,"K",(function(){return se})),n.d(t,"L",(function(){return ce})),n.d(t,"T",(function(){return ue})),n.d(t,"Q",(function(){return le})),n.d(t,"V",(function(){return de})),n.d(t,"R",(function(){return pe})),n.d(t,"S",(function(){return he})),n.d(t,"U",(function(){return fe})),n.d(t,"j",(function(){return me})),n.d(t,"Qb",(function(){return ve})),n.d(t,"X",(function(){return ge})),n.d(t,"Ob",(function(){return be})),n.d(t,"Pb",(function(){return ye})),n.d(t,"pb",(function(){return we})),n.d(t,"Tb",(function(){return Se})),n.d(t,"w",(function(){return ke})),n.d(t,"Gb",(function(){return Ce})),n.d(t,"Fb",(function(){return Ie})),n.d(t,"fc",(function(){return Te})),n.d(t,"Db",(function(){return Ee})),n.d(t,"o",(function(){return _e})),n.d(t,"p",(function(){return xe})),n.d(t,"H",(function(){return Ne})),n.d(t,"t",(function(){return Oe})),n.d(t,"I",(function(){return Me})),n.d(t,"P",(function(){return Le})),n.d(t,"dc",(function(){return De})),n.d(t,"d",(function(){return Re})),n.d(t,"W",(function(){return Pe})),n.d(t,"ab",(function(){return Ae})),n.d(t,"s",(function(){return Fe})),n.d(t,"zb",(function(){return Ve})),n.d(t,"Ab",(function(){return je})),n.d(t,"Bb",(function(){return $e})),n.d(t,"ic",(function(){return ze})),n.d(t,"kc",(function(){return qe})),n.d(t,"qb",(function(){return Ue})),n.d(t,"bb",(function(){return Be})),n.d(t,"jb",(function(){return He})),n.d(t,"eb",(function(){return We})),n.d(t,"sb",(function(){return Qe})),n.d(t,"ob",(function(){return Je})),n.d(t,"nb",(function(){return Xe})),n.d(t,"Xb",(function(){return Ye})),n.d(t,"Wb",(function(){return Ge})),n.d(t,"a",(function(){return Ke})),n.d(t,"g",(function(){return Ze})),n.d(t,"wb",(function(){return et})),n.d(t,"E",(function(){return tt})),n.d(t,"x",(function(){return nt})),n.d(t,"A",(function(){return rt})),n.d(t,"z",(function(){return it})),n.d(t,"y",(function(){return ot})),n.d(t,"C",(function(){return at})),n.d(t,"B",(function(){return st})),n.d(t,"N",(function(){return ct})),n.d(t,"D",(function(){return ut}));const r=2,i=50,o=1024,a=50,s=1e4,c=2e3,u=500,l="n_browser_data",d="n_stored_page_visit",p="n_key",h=45,f=45,m=["metroplexSocketBase","metroplexHTTPBase"],v="DisabledStatus",g="ClientUnlockTime",b="BrowserId",y="CurrentPageVisitCount",w="pvId",S="LastActive",k=5,C=1,I="error",T="warn",E="unfreeze",_=2100,x=300,N=200,O=["innerText","textContent","title","value"],M=["Image","EventTarget","Window","Node","ApplicationCache","AudioTrackList","ChannelMergerNode","CryptoOperation","EventSource","FileReader","HTMLUnknownElement","IDBDatabase","IDBRequest","IDBTransaction","KeyOperation","MediaController","MessagePort","ModalWindow","Notification","SVGElementInstance","Screen","TextTrack","TextTrackCue","TextTrackList","WebSocket","WebSocketWorker","Worker","XMLHttpRequest","XMLHttpRequestEventTarget","XMLHttpRequestUpload"],L="method|finance|sagepay|cart|bag|coupon|affirm|karna|sezzle",D="p",R="v",P="br_id",A="pv_id",F="v",V="seq",j="on_url",$="url",z="ref_url",q="start_at",U="events",B="pc",H="conc",W="cv",Q="vid",J="end_at",X="len",Y="last",G="type",K="occ_at",Z="h_code",ee="j_err",te="events",ne="tag",re="src",ie="txt",oe="hid",ae="mtd",se="code",ce="r_time",ue="line",le="column",de="mname",pe="file",he="frames",fe="msg",me="class",ve="seq_num",ge="lang",be="script_id",ye="script_inst_id",we="mp_sock_inst_id",Se="sock_inst_id",ke="exp_vid_len",Ce="exp_vf_seq",Ie="exp_pc_seq",Te="vid_clicks",Ee="pv_clicks",_e="did_cut_pv",xe="did_cut_vid",Ne="exp_http",Oe="exp_err",Me="http",Le="js",De="userstep",Re="click",Pe="kbd",Ae="loc",Fe="err",Ve="pvi",je="pvp",$e="pvvf",ze="vpnum",qe="cssc";function Ue(){return window.NOIBUJS_CONFIG?window.NOIBUJS_CONFIG:{}}const Be=59e3,He=10,We=100,Qe=["i.noibu","i.staging.noibu","input.b.staging.noibu","input.b.noibu","vf.staging.noibu","vf.noibu"],Je="pv_part",Xe="collect_error",Ye="vid_block",Ge="pv_block",Ke="full_block",Ze="close_conn",et="ok";function tt(){const e=Ue();return e.scriptID?e.scriptID:"default"}function nt(){try{return 20}catch(e){return 2}}function rt(){try{return METROPLEX_CONSECUTIVE_CONNECTION_DELAY}catch(e){return 1e3}}function it(){try{const e="wss://input.noibu.com";return e.endsWith("/")?e.slice(0,-1):e}catch(e){return"ws://localhost:3000"}}function ot(){try{const e="https://input.noibu.com";return e.endsWith("/")?e.slice(0,-1):e}catch(e){return"http://localhost:3000"}}function at(){return ot()+"/pv"}function st(){return ot()+"/metrics"}function ct(){try{return"prod"}catch(e){return"test"}}function ut(){try{return METROPLEX_RETRY_FREQUENCY}catch(t){return e.env.METROPLEX_RETRY_FREQUENCY?e.env.METROPLEX_RETRY_FREQUENCY:3e4}}}).call(this,n(5))},function(e,t,n){var r=n(3),i=n(4);e.exports=function(e,t,n){var o=t&&n||0;"string"==typeof e&&(t="binary"===e?new Array(16):null,e=null);var a=(e=e||{}).random||(e.rng||r)();if(a[6]=15&a[6]|64,a[8]=63&a[8]|128,t)for(var s=0;s<16;++s)t[o+s]=a[s];return t||i(a)}},,function(e,t){var n="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(n){var r=new Uint8Array(16);e.exports=function(){return n(r),r}}else{var i=new Array(16);e.exports=function(){for(var e,t=0;t<16;t++)0==(3&t)&&(e=4294967296*Math.random()),i[t]=e>>>((3&t)<<3)&255;return i}}},function(e,t){for(var n=[],r=0;r<256;++r)n[r]=(r+256).toString(16).substr(1);e.exports=function(e,t){var r=t||0,i=n;return[i[e[r++]],i[e[r++]],i[e[r++]],i[e[r++]],"-",i[e[r++]],i[e[r++]],"-",i[e[r++]],i[e[r++]],"-",i[e[r++]],i[e[r++]],"-",i[e[r++]],i[e[r++]],i[e[r++]],i[e[r++]],i[e[r++]],i[e[r++]]].join("")}},function(e,t){var n,r,i=e.exports={};function o(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function s(e){if(n===setTimeout)return setTimeout(e,0);if((n===o||!n)&&setTimeout)return n=setTimeout,setTimeout(e,0);try{return n(e,0)}catch(t){try{return n.call(null,e,0)}catch(t){return n.call(this,e,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:o}catch(e){n=o}try{r="function"==typeof clearTimeout?clearTimeout:a}catch(e){r=a}}();var c,u=[],l=!1,d=-1;function p(){l&&c&&(l=!1,c.length?u=c.concat(u):d=-1,u.length&&h())}function h(){if(!l){var e=s(p);l=!0;for(var t=u.length;t;){for(c=u,u=[];++d<t;)c&&c[d].run();d=-1,t=u.length}c=null,l=!1,function(e){if(r===clearTimeout)return clearTimeout(e);if((r===a||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(e);try{r(e)}catch(t){try{return r.call(null,e)}catch(t){return r.call(this,e)}}}(e)}}function f(e,t){this.fun=e,this.array=t}function m(){}i.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];u.push(new f(e,t)),1!==u.length||l||s(h)},f.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=m,i.addListener=m,i.once=m,i.off=m,i.removeListener=m,i.removeAllListeners=m,i.emit=m,i.prependListener=m,i.prependOnceListener=m,i.listeners=function(e){return[]},i.binding=function(e){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(e){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return wt}));var r=n(1),i=n.n(r);const o=(e,t,n)=>{if(!(t in e))return;const r=e[t],i=n(r);if("function"==typeof i)try{i.prototype=i.prototype||{},Object.defineProperties(i,{__noibu__:{enumerable:!1,value:!0},__noibu_original__:{enumerable:!1,value:r},__noibu_wrapped__:{enumerable:!1,value:i}})}catch(e){}e[t]=i};function a(e){return e.split("\n").reduce((function(e,t){var n=function(e){var t=s.exec(e);if(!t)return null;var n=t[2]&&0===t[2].indexOf("native"),r=t[2]&&0===t[2].indexOf("eval"),i=c.exec(t[2]);r&&null!=i&&(t[2]=i[1],t[3]=i[2],t[4]=i[3]);return{file:n?null:t[2],methodName:t[1]||"<unknown>",arguments:n?[t[2]]:[],lineNumber:t[3]?+t[3]:null,column:t[4]?+t[4]:null}}(t)||function(e){var t=u.exec(e);if(!t)return null;return{file:t[2],methodName:t[1]||"<unknown>",arguments:[],lineNumber:+t[3],column:t[4]?+t[4]:null}}(t)||function(e){var t=l.exec(e);if(!t)return null;var n=t[3]&&t[3].indexOf(" > eval")>-1,r=d.exec(t[3]);n&&null!=r&&(t[3]=r[1],t[4]=r[2],t[5]=null);return{file:t[3],methodName:t[1]||"<unknown>",arguments:t[2]?t[2].split(","):[],lineNumber:t[4]?+t[4]:null,column:t[5]?+t[5]:null}}(t)||function(e){var t=h.exec(e);if(!t)return null;return{file:t[2],methodName:t[1]||"<unknown>",arguments:[],lineNumber:+t[3],column:t[4]?+t[4]:null}}(t)||function(e){var t=p.exec(e);if(!t)return null;return{file:t[3],methodName:t[1]||"<unknown>",arguments:[],lineNumber:+t[4],column:t[5]?+t[5]:null}}(t);return n&&e.push(n),e}),[])}var s=/^\s*at (.*?) ?\(((?:file|https?|blob|chrome-extension|native|eval|webpack|<anonymous>|\/|[a-z]:\\|\\\\).*?)(?::(\d+))?(?::(\d+))?\)?\s*$/i,c=/\((\S*)(?::(\d+))(?::(\d+))\)/;var u=/^\s*at (?:((?:\[object object\])?.+) )?\(?((?:file|ms-appx|https?|webpack|blob):.*?):(\d+)(?::(\d+))?\)?\s*$/i;var l=/^\s*(.*?)(?:\((.*?)\))?(?:^|@)((?:file|https?|blob|chrome|webpack|resource|\[native).*?|[^@]*bundle)(?::(\d+))?(?::(\d+))?\s*$/i,d=/(\S+) line (\d+)(?: > eval line \d+)* > eval/i;var p=/^\s*(?:([^@]*)(?:\((.*?)\))?@)?(\S.*?):(\d+)(?::(\d+))?\s*$/i;var h=/^\s*at (?:((?:\[object object\])?[^\\/]+(?: \[as \S+\])?) )?\(?(.*?):(\d+)(?::(\d+))?\)?\s*$/i;var f=n(0);function m(e,t=f.kb){return e?e.length<t?e:e.substring(0,t):e}function v(){let e=window.location.href;return window.location.href.startsWith("http")?e=window.location.href:window.parent&&window.parent.location&&window.parent.location.href.startsWith("http")&&(e=window.parent.location.href),m(e)}function g(e){const t={[f.T]:"_",[f.V]:"_",[f.R]:"_"},n=[];if(n[0]=t,"object"!=typeof e||!e)return{[f.S]:n,[f.U]:""};let r=n;e.stack?r=a(e.stack).reduce((e,t)=>{const n={[f.T]:"_",[f.V]:"_",[f.R]:"_"};return t.lineNumber&&"<unknown>"!==t.lineNumber&&(n[f.T]=String(t.lineNumber)),t.methodName&&"<unknown>"!==t.methodName&&(n[f.V]=String(t.methodName)),t.file&&"<unknown>"!==t.file&&(n[f.R]=String(t.file)),t.column&&"number"==typeof t.column&&(n[f.Q]=t.column),e.concat(n)},[]):(e.fileName&&"string"==typeof e.fileName&&(r[0][f.R]=e.fileName),e.lineNumber&&(r[0][f.T]=String(e.lineNumber)),e.columnNumber&&Number.isInteger(e.columnNumber)&&(r[0][f.Q]=e.columnNumber)),r.length>=f.db&&(r=r.slice(0,f.db));const i=e.message?m(e.message):"";return{[f.S]:r,[f.U]:i}}function b(e,t,n,r,i=2e3){return new Promise((o,a)=>{const s=new XMLHttpRequest;s.open(e,t),s.timeout=i,Object.keys(r).forEach(e=>{s.setRequestHeader(e,r[e])}),s.onload=()=>{s.status>=200&&s.status<300?o(s.response):a(new Error("Custom Request failed: "+s.statusText))},s.onerror=()=>{a(new Error("Custom Request failed: "+s.statusText))},n?s.send(JSON.stringify(n)):s.send()})}function y(){const e=Object(f.qb)(),t=["noibu-blocked","creditCard"];return e[f.kc]&&Array.isArray(e[f.kc])&&t.push(...e[f.kc]),new RegExp(t.join("|"))}function w(){const e="1"===window.navigator.doNotTrack,t=function(e){let t=e;return t||(t=window.navigator.userAgent),t=t.toLowerCase(),new RegExp("(bot|crawl(er)?|sp(i|y)der|search|worm|fetch|nutch|headless|baidu|teoma|yandex|woorankreview|pingdom|synthetic|dataprovider|qaautomation|morningscore|wappalyzer|foregenix|StatusCake|SpeedCurve|Outlook-iOS|bitdiscovery|testing|webflow|bingpreview|(r|R)igor|facebookexternalhit/\\d+\\.\\d+)","i").test(t)}(null);return e||t}function S(e){return e?"object"==typeof e?JSON.stringify(e):String(e):""}function k(){return window.performance&&window.performance.now?window.performance.now():Date.now()}function C(e){let t=m(window.location.href);return e&&""!==e.trim()&&"undefined"!==e&&(t=S(m(e))),t}var I={"static.ads-twitter.com":!0,"connect.facebook.net":!0,"d.adroll.com":!0,"sp.analytics.yahoo.com":!0,"www.googleadservices.com":!0,"bat.bing.com":!0,"adservice.google.com":!0,"securepubads.g.doubleclick.net":!0,"adservice.google.ca":!0,"static.doubleclick.net":!0,"s.adroll.com":!0,"platform.twitter.com":!0,"match.adsrvr.org":!0,"px.steelhousemedia.com":!0,"analytics.twitter.com":!0,"www.google-analytics.com":!0,"c.amazon-adsystem.com":!0,"connect.facebook.com":!0,"ssp.lkqd.net":!0,"springserve.com":!0,"input.noibu.com":!0,"input.staging.noibu.com":!0,"vf.noibu.com":!0,"vf.staging.noibu.com":!0};function T(e){return window&&window.localStorage&&navigator.cookieEnabled?window.localStorage.getItem(e):null}function E(e,t){if(!window||!window.localStorage)throw new Error("window or window.localStorage do not exist");if(!navigator.cookieEnabled)throw new Error("cookies disabled");return window.localStorage.setItem(e,t)}function _(e){window&&window.localStorage&&navigator.cookieEnabled&&window.localStorage.removeItem(e)}class x{constructor(){this.pageVisitId=i()(),this.isClientDisabled=null,this.browserId=null,this.pageVisitSeq=null,this.lastActiveTime=new Date,this._setupLocalStorageVars(),this.noibuErrorURL="",this.cltErrorPostCounter=0,this.maxSocketInactiveTime=f.fb}static configureInstance(e){this.instance||(this.instance=new x,this.instance.noibuErrorURL=e)}static getInstance(){if(!this.instance)throw new Error("ClientConfig was not configured");return this.instance}lockClient(e,t){const n=new Date;n.setMinutes(n.getMinutes()+e);const r=this._getClientState();r[f.q]=!0,r[f.f]=n,this._storeBrowserData(r),this.postNoibuErrorAndOptionallyDisableClient(t,!0,f.Sb)}lockClientUntilNextPage(e){this.postNoibuErrorAndOptionallyDisableClient(e,!0,f.Sb)}updateLastActiveTime(e){this.lastActiveTime=e;const t=this._getLsObject();t[f.Y]=e,this._storeBrowserData(t)}getPageVisitSeq(){if(this._pageVisitSeqNeedsReset()){this.pageVisitSeq=0;const e=this._getLsObject();e[f.m]=this.pageVisitSeq+1,e[f.Y]=new Date,this._storeBrowserData(e)}return this.pageVisitSeq}_getLsObject(){const e=T(f.rb);if(!e)return this._generateAndStoreData();let t={};try{t=JSON.parse(e)}catch(e){return this._generateAndStoreData()}return null==t[f.c]||null==t[f.q]||null==t[f.m]||null==t[f.Y]?this._generateAndStoreData():t}_pageVisitSeqNeedsReset(){const e=this._getClientState(),t=new Date;return t.setMinutes(t.getMinutes()-f.Lb),new Date(e[f.Y])<t}_setupLocalStorageVars(){const e=this._getClientState();if(this._pageVisitSeqNeedsReset()&&(e[f.m]=0),this.browserId=e[f.c],this.pageVisitSeq=e[f.m],this.isClientDisabled=e[f.q],this.isClientDisabled||(e[f.m]+=1,e[f.Y]=new Date),"integration_test"===Object(f.N)()&&(e[f.yb]=this.pageVisitId),e[f.m]>=f.ib){x.getInstance().postNoibuErrorAndOptionallyDisableClient("Hit max page visits, disabling client",!0,f.Rb);const t=new Date;t.setMinutes(t.getMinutes()+f.e),e[f.f]=t}null===this._storeBrowserData(e)[f.c]&&(x.getInstance().postNoibuErrorAndOptionallyDisableClient("Null browser in local storage, disabling client",!0,f.Rb),this.browserId=null)}_getClientState(){const e=this._getLsObject();return e[f.f]&&new Date(e[f.f])<=new Date&&(e[f.f]=null,e[f.q]=!1,this._storeBrowserData(e)),e}_generateAndStoreData(){return this._storeBrowserData(this._generateNewBrowserData())}_generateNewBrowserData(){const e={[f.q]:!1,[f.c]:i()(),[f.m]:0,[f.f]:null,[f.Y]:new Date};return"integration_test"===Object(f.N)()&&(e[f.yb]=this.pageVisitId),e}_storeBrowserData(e){try{return E(f.rb,JSON.stringify(e)),e}catch(e){this.postNoibuErrorAndOptionallyDisableClient("Error writing browser data to local storage, disabling client: "+e.message,!0,f.Rb);return{[f.q]:!0,[f.c]:null,[f.m]:0}}}postNoibuErrorAndOptionallyDisableClient(e,t,n,r=!1){if(this.isClientDisabled)return;t&&(this.isClientDisabled=!0);let i=`Noibu Browser ID(${this.browserId?this.browserId:""}), PV ID ${this.pageVisitId}, Script ID ${Object(f.E)()}, and User Agent ${window.navigator.userAgent} error: ${S(e)}`;if(this.cltErrorPostCounter>=f.cb){const e=new Date;e.setMinutes(e.getMinutes()+10);const t=this._getClientState();t[f.q]=!0,t[f.f]=e,this._storeBrowserData(t),this.isClientDisabled=!0,i="Shutting collect off, we reached the maximum limit of collect errors sent."}const o={url:window.location.href,err_msg:i,sev:n},a={"content-type":"application/json"};r?fetch(this.noibuErrorURL,{method:"POST",headers:a,body:JSON.stringify(o),keepalive:!0}):b("POST",this.noibuErrorURL,o,a).catch(()=>{}),n===f.Rb&&(this.cltErrorPostCounter+=1)}isInactive(){const e=new Date;return e.setSeconds(e.getSeconds()-this.maxSocketInactiveTime),this.lastActiveTime<e}}class N{constructor(){this.expectedVideoLength=0,this.expectedVfSeq=0,this.expectedPvPart=0,this.videoClicks=0,this.pvClicks=0,this.errCount=0,this.httpCount=0,this.didCutPv=!1,this.didCutVideo=!1,this.writeTimeout=null,this._setupListeners()}static getInstance(){return this.instance||(this.instance=new N),this.instance}addVideoFragData(e,t){this.expectedVfSeq=e,this.expectedVideoLength=t}setPvPart(e){this.expectedPvPart=e}addVideoClick(){this.videoClicks+=1}addPvClick(){this.pvClicks+=1}addError(){this.errCount+=1}addHttpEvent(){this.httpCount+=1}setDidCutVideo(){this.didCutVideo=!0}setDidCutPv(){this.didCutPv=!0}_setupListeners(){["unload","pagehide"].forEach(e=>window.addEventListener(e,()=>{this._postMetricsIfActive()}))}_postMetricsIfActive(){x.getInstance().isClientDisabled||x.getInstance().isInactive()||this.postMetrics()}postMetrics(){const e={[f.b]:x.getInstance().browserId,[f.Hb]:x.getInstance().pageVisitId,[f.h]:f.l,[f.ec]:f.k,[f.w]:this.expectedVideoLength,[f.Gb]:this.expectedVfSeq,[f.Fb]:this.expectedPvPart,[f.fc]:this.videoClicks,[f.Db]:this.pvClicks,[f.o]:this.didCutPv,[f.p]:this.didCutVideo,[f.H]:this.httpCount,[f.t]:this.errCount,[f.xb]:document.location.href};window.fetch&&window.fetch(Object(f.B)(),{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify(e),keepalive:!0})}}class O{constructor(){this.isLocalStorageSupported=this._testLocalStorageSupported(),this.latestPageVisitFrag=null,this.writeTimeout=null,this.flushedLocalStorage=!1,this.isLocalStorageSupported&&this._postPreviousPageVisit()}static getInstance(){return this.instance||(this.instance=new O),this.instance}checkAndStoreRetryQueue(e,t){const{type:n,payload:r}=e[e.length-1];if(n!==f.Ib||!r[f.Ab])return;(r[f.Ab][f.Eb]?r[f.Ab][f.Eb]:[]).filter(e=>e[f.ac]===f.dc&&e[f.dc][f.ac]===f.d||e[f.ac]===f.ab).length>0&&this.writePageVisitsFromRetryQueue(e,t)}writePageVisitsFromRetryQueue(e,t){const n=[];for(let t=0;t<e.length;t+=1){const{type:r,payload:i}=e[t];if(r===f.Ib){const e=i[f.Ab];n.push(e)}}this._writePageVisitFrags(n,t)}_writePageVisitFrags(e,t){const n={pageVisitFrags:e,pageVisitInfo:t,timestamp:new Date},r=JSON.stringify(n);if(!(r.length>5242880))try{E(f.ub,r)}catch(e){_(f.ub);const t=function(){if(!window||!window.localStorage||!window.localStorage.key)return 0;if(!navigator.cookieEnabled)return 0;let e=0;for(let t=0;t<window.localStorage.length;t+=1){const n=window.localStorage.key(t);if(n){const t=T(n);t&&(e+=t.length)}}return e}();x.getInstance().postNoibuErrorAndOptionallyDisableClient(`Error writing page visit to local storage: ${e}, UserAgent: ${navigator.userAgent},  json size: ${r.length}, LS size: ${t}, `,!1,f.Rb)}}_getPostData(){const e=T(f.ub);if(!e)return null;let t={};try{t=JSON.parse(e)}catch(t){return _(f.ub),x.getInstance().postNoibuErrorAndOptionallyDisableClient(`Error parsing page visit string '${e}': ${t}`,!1,f.Rb),null}if(t.timestamp){const e=new Date;if(e.setSeconds(e.getSeconds()-f.fb),e>=Date.parse(t.timestamp))return null}const n={[f.zb]:t.pageVisitInfo,[f.Ab]:[],[f.Bb]:[]};n[f.zb][f.M]=!0;for(let e=0;e<t.pageVisitFrags.length;e+=1)n[f.Ab].push(t.pageVisitFrags[e]);return n}_testLocalStorageSupported(){try{const e="N".repeat(512);E(f.tb,e)}catch(e){return!1}return _(f.tb),!0}_postPreviousPageVisit(){this._getPostPageVisitPromise().then(()=>{this._updateLocalStorageFlushed()}).catch(()=>{this._updateLocalStorageFlushed()})}_updateLocalStorageFlushed(){this.flushedLocalStorage=!0,_(f.ub)}_getPostPageVisitPromise(){return new Promise((e,t)=>{const n=this._getPostData();if(!n)return void e();b("POST",Object(f.C)(),n,{"content-type":"application/json"}).then(()=>{e()}).catch(e=>{t(new Error("Page visit post request rejected due to: ",e))})})}}class M{constructor(e){const t=Object(f.z)();this.forceClosed=!1,this.socket=null,this.socketInstanceId=null,this.previousMessageType="",this.currentConnectionAttempts=0,this.connectionCount=0,this.sessionStartTime=k(),this.connectionPromise=null,this.pageVisitInfoSent=!1,this.connectionURL=`${t}/${f.ob}`,this.postURL=Object(f.C)(),this.messageSequenceNum=0,this.latestReceivedSeqNumber=-1,this.isRetryLoopDisabled=!1,this.retryMessageQueue=[],this.metroplexTypeLock={},this.initialURL=v(),this.initialReferingURL=window.document.referrer?m(window.document.referrer):"",this.sessionTimestamp=new Date,this.latestReceivedSeqNumStoredTime=new Date,this.instanceId=i()(),this.scriptInstanceId=e}static getInstance(e){return this.instance||(this.instance=new M(e),this.instance.start()),this.instance}start(){this.connectSocket().then(()=>{this._setupOffloadEvents()})}_addSeqNumToPayload(e){e[f.Ab]?(e[f.Ab][f.Qb]=this.messageSequenceNum,this.messageSequenceNum+=1):e[f.Bb]&&(e[f.Bb][f.Qb]=this.messageSequenceNum,this.messageSequenceNum+=1)}sendMessage(e,t){if(e in this.metroplexTypeLock||x.getInstance().isClientDisabled)return;const n=t;if(this._addSeqNumToPayload(n),this.retryMessageQueue.push({payload:n,type:e}),O.getInstance().checkAndStoreRetryQueue(this.retryMessageQueue,this.getPageInformation()),this.isConnected()&&this.pageVisitInfoSent&&this._sendSocketMessage(n),this.previousMessageType=e,e===f.Ib&&t[f.Ab]){const e=t[f.Ab][f.Eb]?t[f.Ab][f.Eb]:[];this._updateLatestPvTimestamp(e)}}_updateLatestPvTimestamp(e){e.filter(e=>e[f.ac]===f.dc).length>0&&x.getInstance().updateLastActiveTime(new Date)}isConnected(){return null!==this.socket&&1===this.socket.readyState}isConnecting(){return null!==this.socket&&0===this.socket.readyState}close(){this.forceClosed=!0,(this.isConnected()||this.isConnecting())&&this.socket.close(1e3)}handleConnect(e){this.isConnected()||this.isConnecting()||(this.currentConnectionAttempts+=1,this.socket=new WebSocket(this.connectionURL),this.socketInstanceId=i()(),this.socket.onerror=()=>{},this.socket.onclose=()=>{this.pageVisitInfoSent=!1,this.forceClosed||this.isConnecting()||(clearInterval(this.retryMetroplexInterval),this.currentConnectionAttempts>=Object(f.x)()?x.getInstance().lockClientUntilNextPage("Too many reconnection attempts, locking until next page"):this.connectionCount>=f.eb?x.getInstance().lockClientUntilNextPage("Too many connections, locking until next page"):setTimeout(()=>{this.handleConnect(e)},this.currentConnectionAttempts**2*Object(f.A)()))},this.socket.onmessage=e=>{this._onSocketMessage(e)},this.socket.onopen=()=>{this._onSocketOpen(),e()})}connectSocket(){return this.isConnected()||this.isConnecting()||(this.connectionPromise=new Promise(e=>{this.handleConnect(e),window.addEventListener("visibilitychange",()=>{this.forceClosed||this.isConnected()||this.isConnecting()||this.handleConnect(e)})})),this.connectionPromise}addEndTimeToPayload(e){const t=Math.ceil(k()-this.sessionStartTime),n=new Date(this.sessionTimestamp.getTime()+t).toISOString();e[f.r]=n}_onSocketOpen(){this.isConnected()&&!x.getInstance().isClientDisabled&&(this._sendSocketMessage(this.getPageInformation()),this.pageVisitInfoSent=!0,this.currentConnectionAttempts=0,this.previousMessageType="",this._sendUnconfirmedMessages(),this.setupRetryMechanism(),this.connectionCount+=1)}_onSocketMessage(e){switch(e.data){case f.Xb:this.metroplexTypeLock[f.hc]=!0,N.getInstance().setDidCutVideo();break;case f.Wb:this.metroplexTypeLock[f.Ib]=!0,N.getInstance().setDidCutPv();break;case f.a:x.getInstance().lockClient(1440,"Metroplex blocked script"),this.close();break;case f.g:this.close();break;case f.wb:break;default:if(e.data.includes(f.Qb)){const t=e.data.split(f.Qb+":");if(t.length<2){x.getInstance().postNoibuErrorAndOptionallyDisableClient("Invalid message received from metroplex while clearing retry queue "+e.data,!1,f.Rb);break}const n=parseInt(t[1],10);n<=this.latestReceivedSeqNumber?this.isRetryLoopDisabled=!0:this.isRetryLoopDisabled=!1,this.latestReceivedSeqNumber=n,this._clearRetryQueue(n)}}}_messagePayloadHasLargerSeqNum(e,t,n){return e.payload[t]&&e.payload[t][f.Qb]&&e.payload[t][f.Qb]>n}_clearRetryQueue(e){this.latestReceivedSeqNumStoredTime=new Date,this.retryMessageQueue=this.retryMessageQueue.filter(t=>this._messagePayloadHasLargerSeqNum(t,f.Ab,e)||this._messagePayloadHasLargerSeqNum(t,f.Bb,e))}_sendUnconfirmedMessages(){if(!this.isConnected()||x.getInstance().isClientDisabled||this.isConnecting())return;const e=new Date;if(e.setSeconds(e.getSeconds()-Object(f.D)()),!(e>=this.latestReceivedSeqNumStoredTime||this.isRetryLoopDisabled)){this.retryMessageQueue=this.retryMessageQueue.filter(e=>!(e.type in this.metroplexTypeLock));for(let e=0;e<this.retryMessageQueue.length;e+=1){const{type:t,payload:n}=this.retryMessageQueue[e];if(!this._sendSocketMessage(n))break;this.previousMessageType=t}}}setupRetryMechanism(){this.retryMetroplexInterval=setInterval(()=>{this._sendUnconfirmedMessages()},Object(f.D)())}_setupOffloadEvents(){window.addEventListener("unload",()=>{this._handleUnload()})}_handleUnload(){this.close(),x.getInstance().isClientDisabled||x.getInstance().isInactive()||this.postFullPageVisit()}postFullPageVisit(){if(0===this.retryMessageQueue.length)return;let e=0,t={[f.zb]:this.getPageInformation(),[f.Ab]:[],[f.Bb]:[],[f.ic]:this.connectionCount};t[f.zb][f.M]=!0,this.retryMessageQueue.forEach(n=>{let{type:r,payload:i}=n;const o=new Blob([JSON.stringify(i)]).size;if(!(e>f.bb))switch(e+=o,e>=f.bb&&(this.postMessage(t),t={[f.zb]:this.getPageInformation(),[f.Ab]:[],[f.Bb]:[],[f.ic]:t[f.ic]},t[f.zb][f.M]=!0,e=0),r){case f.hc:t[f.Bb].push(i[f.Bb]);break;case f.Ib:t[f.Ab].push(i[f.Ab])}}),this.postMessage(t)}postMessage(e){const t=e;t[f.ic]+=1,"test"===Object(f.N)()?navigator.sendBeacon(this.postURL,JSON.stringify(t)):window.fetch&&fetch(this.postURL,{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify(t),keepalive:!0})}_sendSocketMessage(e){return!this.closeIfInactive()&&(this.socket.send(JSON.stringify(e)),!0)}closeIfInactive(){const e=x.getInstance().isInactive();return e&&!x.getInstance().isClientDisabled&&(x.getInstance().lockClientUntilNextPage("Session is inactive, locking until next page"),this.close(),N.getInstance().postMetrics(),this.postFullPageVisit()),e}getPageInformation(){const e={[f.b]:x.getInstance().browserId,[f.Hb]:x.getInstance().pageVisitId,[f.ec]:f.n,[f.Kb]:x.getInstance().getPageVisitSeq(),[f.xb]:this.initialURL,[f.Mb]:this.initialReferingURL,[f.Vb]:this.sessionTimestamp.toISOString(),[f.i]:this.connectionCount,[f.h]:f.l,[f.M]:!1,[f.Ob]:Object(f.E)(),[f.Pb]:this.scriptInstanceId,[f.pb]:this.instanceId,[f.Tb]:this.socketInstanceId},t=function(){const e=window.navigator.userLanguage||window.navigator.language;return""!==e&&e?e.toLowerCase():null}();return t&&(e[f.X]=t),e}}class L{constructor(){this.partCounter=0,this.pvMap={},this.partCounter=0,this.pvEventLength=0,this.visibilityChangedCounter=0,this.totalPvEventLength=0,this.inDebounceHandle=0,this.isInAcceleratedPvPostMode=!1}static configureInstance(){this.instance||(this.instance=new L)}static getInstance(){if(!this.instance)throw new Error("Pagevisit was never configured");return this.instance}addPageVisitEvents(e,t){e.forEach(e=>{this._addPageVisitEvent(e,t)}),this._sendPageVisitMessage()}addPageVisitEvent(e,t){const n=this._addPageVisitEvent(e,t);return this._sendPageVisitMessage(),n}_addPageVisitEvent(e,t){if(!("occurredAt"in e)||!("event"in e))throw new Error("missing attributes in the eventObj");const n={[f.ac]:t,[f.vb]:e.occurredAt,[t]:e.event};this.pvEventLength>=f.gb&&this._sendPageVisitMessage();const r=i()();return this.pvMap[r]=n,this.pvEventLength+=1,this.totalPvEventLength+=1,r}static makePageVisitFrag(e,t){const n={};return n[f.Eb]=e,n[f.Jb]=t,M.getInstance().addEndTimeToPayload(n),n}_sendPageVisitMessage(){const e=Object.keys(this.pvMap).map(e=>this.pvMap[e]);if(0===e.length)return;if(this.partCounter>=f.hb)return void x.getInstance().lockClientUntilNextPage(`NoibuJS will stop processing parts because we reached max parts: ${f.hb}. Variables: \n      total Pv Event Length: ${this.totalPvEventLength}\n      visibility Changed Counter: ${this.visibilityChangedCounter}\n      `);const t=L.makePageVisitFrag(e,this.partCounter);N.getInstance().setPvPart(this.partCounter);const n={};n[f.Ab]=t,M.getInstance().sendMessage(f.Ib,n),this.pvMap={},this.pvEventLength=0,this.partCounter+=1}}class D{constructor(){this.eventsToDebounce={},this.registerInputType(f.ab,0),this.registerInputType(f.s,f.mb),this.registerInputType(f.I,f.mb),this.registerInputType(f.W,f.mb,f.dc),this._setupUnloadHandler()}static getInstance(){return this.instance||(this.instance=new D),this.instance}registerInputType(e,t,n=e){e in this.eventsToDebounce||(this.eventsToDebounce[e]={timeout:null,events:[],debouncePeriod:t,eventName:n})}addEvent(e,t){if(!(t in this.eventsToDebounce))throw new Error(`Type: ${t} is not in eventsToDebounce`);this.eventsToDebounce[t].events.push({event:e,occurredAt:(new Date).toISOString()}),this._debouncePvEvents(t)}_debouncePvEvents(e){clearTimeout(this.eventsToDebounce[e].timeout),this.eventsToDebounce[e].timeout=setTimeout(()=>{this.eventsToDebounce[e].timeout=null,L.getInstance().addPageVisitEvents(this.eventsToDebounce[e].events,this.eventsToDebounce[e].eventName),this.eventsToDebounce[e].events=[]},this.eventsToDebounce[e].debouncePeriod)}_setupUnloadHandler(){window.addEventListener("unload",()=>{Object.values(this.eventsToDebounce).forEach(e=>{L.getInstance().addPageVisitEvents(e.events,e.eventName)})})}}function R(e){return{[f.cc]:C(e.filename),[f.ac]:f.P,[f.O]:g(e.error)}}function P(e,t){let n=t;switch(t.error&&t.error.originalError&&(n=t.error.originalError),e){case"XMLHttpRequest":return function(e){return{[f.cc]:C(e.responseURL),[f.ac]:f.I,[f.G]:e.status}}(n);case"ErrorEvent":return R(n);case"Event":return function(e){return{[f.cc]:C(e.target.src),[f.ac]:f.u}}(n);case"Response":return function(e){return{[f.cc]:C(e.url),[f.ac]:f.I,[f.G]:e.status}}(n);case"WrappedException":return R(n);case"FetchException":return function(e){return{[f.cc]:C(e.url),[f.ac]:f.P,[f.O]:g({message:"Could not use the fetch API: "+S(e.str)})}}(n);default:try{return R(n)}catch(e){return null}}}function A(e,t){const n=P(e,t);if(!n||!n[f.cc]||n[f.ac]===f.u)return;const r=n[f.cc];if(function(e){try{return URL(e),!0}catch(e){return!1}}(r)){const e=new URL(r);if(e.hostname in I||!e.protocol.startsWith("http"))return}(function(e){if(e[f.ac]===f.P){if(e[f.O]){const t=e[f.O][f.S];if(t&&t.length>0){const n=t[0][f.R].toLowerCase(),r=t[0][f.V].toLowerCase();if(n.includes("noibu")&&!r.includes("nbuwrapper"))return x.getInstance().postNoibuErrorAndOptionallyDisableClient(e,!1,f.Rb),!0}}else if(e[f.U]){if(e[f.U].toLowerCase().includes("noibu"))return x.getInstance().postNoibuErrorAndOptionallyDisableClient(e,!1,f.Rb),!0}}else if(e[f.ac]===f.I&&e[f.cc]){const t=e[f.cc];if("string"==typeof t)for(let n=0;n<f.sb.length;n+=1){const r=f.sb[n];if(t.includes(r))return x.getInstance().postNoibuErrorAndOptionallyDisableClient(e,!1,f.Rb),!0}}return!1})(n)||(N.getInstance().addError(),D.getInstance().addEvent(n,f.s))}let F=0;function V(e){if("function"!=typeof e)return e;try{if(e.__noibu__)return e;if(e.__noibu_wrapped__)return e.__noibu_wrapped__}catch(t){return e}const nbuWrapper=function(...t){try{const n=Array.prototype.slice.call(t).map(e=>V(e));return e.handleEvent?e.handleEvent.apply(this,n):e.apply(this,n)}catch(e){throw A("WrappedException",{error:e}),F+=1,setTimeout(()=>{F-=1}),e}};try{for(const t in e)Object.prototype.hasOwnProperty.call(e,t)&&(nbuWrapper[t]=e[t])}catch(e){}nbuWrapper.prototype=e.prototype||{},Object.defineProperty(e,"__noibu_wrapped__",{enumerable:!1,value:nbuWrapper}),Object.defineProperties(nbuWrapper,{__noibu__:{enumerable:!1,value:!0},__noibu_original__:{enumerable:!1,value:e}});try{Object.getOwnPropertyDescriptor(nbuWrapper,"name").configurable&&Object.defineProperty(nbuWrapper,"name",{get:()=>e.name})}catch(t){return e}return nbuWrapper}function j(e){e&&e.constructor&&e.constructor.name&&"undefined"!==e.constructor.name&&!(F>0)&&A(e.constructor.name,e)}function $(){f.v.forEach(e=>{const t=window[e],n=t&&t.prototype;n&&n.hasOwnProperty&&n.hasOwnProperty("addEventListener")&&(o(n,"addEventListener",(function(e){return function(t,n,r){if(!n)return e.call(this,t,n,r);let i;if(n.handleEvent){const e=V(n.handleEvent.bind(n));i=n,i.handleEvent=e}else i=V(n);return e.call(this,t,i,r)}})),o(n,"removeEventListener",(function(e){return function(t,n,r){let i=n;try{i=i&&(i.__noibu_wrapped__||i)}catch(e){}return e.call(this,t,i,r)}})))}),window.addEventListener("error",j,!0)}class z{constructor(e){const t=e;(!t.resp_time||t.resp_time<0)&&(t.resp_time=0),t[f.J]=e[f.J].toUpperCase(),t.url=m(S(t.url)),this.httpEvent=t}saveHTTPEvent(){this.httpEvent&&this.httpEvent.url&&""!==this.httpEvent.url.trim()&&(N.getInstance().addHttpEvent(),D.getInstance().addEvent(this.httpEvent,f.I))}}function q(e){return"number"!=typeof e||(e>=400||e<=0)}function U(){const e=window.XMLHttpRequest,t=e&&e.prototype;if(!t||!t.hasOwnProperty||!t.hasOwnProperty("open"))return;const n=Object.getOwnPropertyDescriptor(t,"open");if(!n.writable){if(!n.configurable)return void function(e){const t=Object.getOwnPropertyDescriptor(e,"send");if(!t.writable){if(!t.configurable)return;Object.defineProperty(e,"send",{writable:!0})}o(e,"send",(function(e){return function(t){const n=t?"POST":"GET",r=new Date;return this.addEventListener("loadend",()=>{const e=new Date,t=Math.abs(e-r),i={[f.J]:n,[f.K]:this.status,[f.cc]:this.responseURL,[f.L]:t};let o=new z(i);o.saveHTTPEvent(),o=null,q(this.status)&&A("XMLHttpRequest",this)}),e.call(this,t)}}))}(t);Object.defineProperty(t,"open",{writable:!0})}!function(e){o(e,"open",(function(e){return function(t,n,r=!0,i=null,o=null){const a=new Date;return this.addEventListener("loadend",()=>{const e=new Date,r=Math.abs(e-a),i={[f.J]:t,[f.K]:this.status,[f.cc]:n,[f.L]:r};let o=new z(i);o.saveHTTPEvent(),o=null,q(this.status)&&A("XMLHttpRequest",this)}),e.call(this,t,n,r,i,o)}}))}(t)}function B(){U(),function(){const e=window;e&&e.hasOwnProperty&&e.hasOwnProperty("fetch")&&o(e,"fetch",(function(e){return function(t,n){const r=e.call(this,t,n),i=n&&n.method?n.method:"GET",o=new Date;return r.then(e=>{const n=new Date,r=Math.abs(n-o),a={[f.J]:i,[f.K]:e.status,[f.cc]:t,[f.L]:r};let s=new z(a);s.saveHTTPEvent(),s=null,q(e.status)&&A("Response",e)}).catch(e=>{A("FetchException",{url:t.url?t.url:window.location.href,str:e})}),r}}))}()}function H(e){const t=e;return t[f.j]=S(t[f.j]),t}const W=["\\b(view|add|my)\\b.*\\b(cart|bag|basket|bucket|box)\\b","\\b(buy now)\\b","^backorder$","\\b(acquista ora)\\b","\\b(buy this)\\b","\\b(ajouter|mon)\\b.*\\b(panier)\\b","\\b(aggiungi)\\b.*\\b(cart|borsa|carrello)\\b","^ajouter à la shopping bag$","^aggiungi$","^aggiungi alla shopping bag$","\\b(warenkorb)\\b","(^kaufen$)","^купить$","\\b(agregar)\\b.*\\b(carrito)\\b","\\b(adicionar)\\b.*\\b(carrinho)\\b","^carrinho$","^añadir al carrito de compras$","(^añadir al carrito$)","(add another)","(in winkelmand)","(sepete ekle)","(Lagg I Varukorgen)","(ΠΡΟΣΘΗΚΗ ΣΤΟ ΚΑΛΑΘΙ)","(Lägg i varukorgen)","(Köp)","(カートに追加)","^添加至购物袋$","^购买$","^購入する$","(أضف الى السلة)"],Q=["(paypal)","(checkout|payment|check out)","(l.?achat|règlement|paiement|la commande)","(passer).*(commande)","valider mon panier","(acheter maintenant)","^caisse$","(gå vidare till kassan)","(cassa|acquisto)","^vai alla cassa$","^procedi all.?acquisto$","^procedi al checkout$","^siguiente$","(kasse)","^zur kasse gehen$","^bezahlen$","^weiter zum checkout$","(comprar ahora)","^comprar$","(prosseguir com a compra)","^pasar por la caja$","^afrekenen$","^compre$","(continue to pay)","(naar de kassa)","Перейти к оформлению заказа","^купить сейчас$","^bestellen$","(Alışverişi Tamamla)","^Till kassan$","(チェックアウトに進む)","^去结算$","^付款。$","^お支払い$","(تاكيد الطلب)"],J=["(checkout|continue) (with paypal)","^continue to paypal$","^weiter zu paypal$","^continue to afterpay$","^braintree_paypal$","^pay and place order$","^mit paypal bezahlen$","^continue to payment securely$","(continua su paypal)","(apple pay|applepay)","(amazon pay|amazonpay|continue with amazon)","(sezzlepay)","(place order)","(place your order)","(order confirmation)","(complete purchase)","submit.*order","(pay now)","(^pay it now$)","(make payment)","(^make payment$)","(complete order)","^complete your order$","(fazer pedido)","^encomendar$","((realizar) (pedido|pago))","^finalizar compra$","^pagar$","^jetzt kaufen$","^bestellung aufgeben$","^bestellung prüfen$","^auftragsbestätigung$","^bestelling plaatsen$","^passer la commande$","(je confirme et je paye)","(accéder au paiement)","^passer au paiement$","(Valider et continuer)","^valider la commande$","(^passez la commande$)","^invia ordine$","(effettua ordine)","^effettua l.?ordine$","(conferma acquisto)","^conferma l.?acquisto$","^confirmation de commande$","^confirma l.?ordine$","^conferma l.?ordine$","^conferma ordine$","(SİPARİŞİ TAMAMLA)","^Разместить заказ$","(Slutför köp)","(注文する)","(إنشاء الطلب)","(注文を確定)","^お支払いへ進む$","^确认下单$"];class X{constructor(){this.textCapturedWhiteListRegex=new RegExp(W.concat(Q).concat(J).join("|"),"i"),this.htmlIDWhiteListRegex=new RegExp(f.jc,"i")}static getInstance(){return this.instance||(this.instance=new X),this.instance}monitorClicks(){window.addEventListener("click",this._onClickHandle.bind(this),!0)}_onClickHandle(e){const t=function(){const e=Object(f.qb)(),t=["noibu-blocked"];return e[f.kc]&&Array.isArray(e[f.kc])&&t.push(...e[f.kc]),t}();if(e.srcElement){const n=e.srcElement;let r=this._getTextualContentFromEl(n,!0);"IMG"===n.tagName&&(r=n.alt?n.alt:"");const i=n.className?n.className:"";let o=r.replace(/(\r\n|\n|\r|\\n)/gm,"").trim(),a="";n.tagName&&(a=n.tagName.toLowerCase());let s=n.id?n.id:"";if("string"!=typeof s&&(s=""),!this.textCapturedWhiteListRegex.test(o)&&!this.htmlIDWhiteListRegex.test(s)){"input"===a?n.type&&"button"===n.type||(o="*"):"textarea"!==a&&"select"!==a||(o="*");o=t.filter(e=>e===i).length>0?"*":o}o=function(e){return e.replace(/[0-9]/g,"*")}(o);const c={[f.Ub]:n.src?n.src:"",[f.Zb]:o,[f.Yb]:a,[f.F]:s,[f.ac]:f.d,[f.j]:i};N.getInstance().addPvClick(),L.getInstance().addPageVisitEvents([{event:H(c),occurredAt:(new Date).toISOString()}],f.dc)}}_parseTextFromParentElement(e){let t=e;const n=[];let r=0;for(;t&&!(r>=5);)n.push(t),t=t.parentNode,r+=1;for(let e=0;e<n.length;e+=1){const t=n[e];if("BUTTON"===t.tagName)return this._getTextualContentFromEl(t,!1)}return""}_getTextualContentFromEl(e,t){let n="";for(let t=0;t<f.Cb.length;t+=1){const r=f.Cb[t];if(e[r]&&""!==e[r].trim()){n=e[r];break}}return""===n&&t&&(n=this._parseTextFromParentElement(e)),n.length>100&&(n=n.substring(0,97)+"..."),n}}class Y{constructor(){this.inputsTracked={}}monitor(){this._attachListenersToInputTags("input","textarea"),this._listenForNewInputTags("input","textarea")}_listenForNewInputTags(...e){new MutationObserver(t=>{t.forEach(t=>{for(let n=0;n<t.addedNodes.length;n+=1)if("FORM"===t.addedNodes[n].tagName){const e=t.addedNodes[n].getElementsByTagName("input");Array.prototype.slice.call(e).forEach(e=>{this._attachListenerToTextInput(e)})}else e.forEach(e=>{t.addedNodes[n].tagName===e.toUpperCase()&&this._attachListenerToTextInput(t.addedNodes[n])})})}).observe(window.document,{subtree:!0,childList:!0})}_attachListenersToInputTags(...e){e.forEach(e=>{const t=window.document.getElementsByTagName(e);Array.prototype.slice.call(t).forEach(e=>{this._attachListenerToTextInput(e)})})}_attachListenerToTextInput(e){const t=e.placeholder||e.name||"";this.inputsTracked[t]||""===t||(this.inputsTracked[t]=!0,e.addEventListener("input",()=>{D.getInstance().addEvent(H({[f.Ub]:"",[f.Zb]:t,[f.Yb]:e.tagName.toLowerCase(),[f.F]:e.id,[f.ac]:f.W,[f.j]:e.className}),f.W)}))}}let G=window.location.href;var K,Z=function(){return(Z=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};function ee(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function te(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a}function ne(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(te(arguments[t]));return e}function re(e){return e.nodeType===e.ELEMENT_NODE}function ie(e){var t,n=null===(t=e)||void 0===t?void 0:t.host;return Boolean(n&&n.shadowRoot&&n.shadowRoot===e)}!function(e){e[e.Document=0]="Document",e[e.DocumentType=1]="DocumentType",e[e.Element=2]="Element",e[e.Text=3]="Text",e[e.CDATA=4]="CDATA",e[e.Comment=5]="Comment"}(K||(K={}));var oe=1,ae=RegExp("[^a-z0-9-_:]");function se(e){try{var t=e.rules||e.cssRules;return t?Array.from(t).map(ce).join(""):null}catch(e){return null}}function ce(e){return function(e){return"styleSheet"in e}(e)?se(e.styleSheet)||"":e.cssText}var ue=/url\((?:(')([^']*)'|(")(.*?)"|([^)]*))\)/gm,le=/^(?!www\.|(?:http|ftp)s?:\/\/|[A-Za-z]:\\|\/\/|#).*/,de=/^(data:)([^,]*),(.*)/i;function pe(e,t){return(e||"").replace(ue,(function(e,n,r,i,o,a){var s,c=r||o||a,u=n||i||"";if(!c)return e;if(!le.test(c))return"url("+u+c+u+")";if(de.test(c))return"url("+u+c+u+")";if("/"===c[0])return"url("+u+(((s=t).indexOf("//")>-1?s.split("/").slice(0,3).join("/"):s.split("/")[0]).split("?")[0]+c)+u+")";var l=t.split("/"),d=c.split("/");l.pop();for(var p=0,h=d;p<h.length;p++){var f=h[p];"."!==f&&(".."===f?l.pop():l.push(f))}return"url("+u+l.join("/")+u+")"}))}var he=/^[^ \t\n\r\u000c]+/,fe=/^[, \t\n\r\u000c]+/;function me(e,t){if(!t||""===t.trim())return t;var n=e.createElement("a");return n.href=t,n.href}function ve(){var e=document.createElement("a");return e.href="",e.href}function ge(e,t,n,r){return"src"===n||("href"===n||"xlink:href"===n)&&r?me(e,r):"background"!==n||!r||"table"!==t&&"td"!==t&&"th"!==t?"srcset"===n&&r?function(e,t){if(""===t.trim())return t;var n=0;function r(e){var r,i=e.exec(t.substring(n));return i?(r=i[0],n+=r.length,r):""}for(var i=[];r(fe),!(n>=t.length);){var o=r(he);if(","===o.slice(-1))o=me(e,o.substring(0,o.length-1)),i.push(o);else{var a="";o=me(e,o);for(var s=!1;;){var c=t.charAt(n);if(""===c){i.push((o+a).trim());break}if(s)")"===c&&(s=!1);else{if(","===c){n+=1,i.push((o+a).trim());break}"("===c&&(s=!0)}a+=c,n+=1}}}return i.join(", ")}(e,r):"style"===n&&r?pe(r,ve()):r:me(e,r)}function be(e,t,n){if(!e)return!1;if(e.nodeType===e.ELEMENT_NODE){if("string"==typeof t){if(e.classList.contains(t))return!0}else e.classList.forEach((function(e){if(t.test(e))return!0}));return!(!n||!e.matches(n))||be(e.parentNode,t,n)}return e.nodeType,e.TEXT_NODE,be(e.parentNode,t,n)}function ye(e,t){var n,r,i=t.doc,o=t.blockClass,a=t.blockSelector,s=t.maskTextClass,c=t.maskTextSelector,u=t.inlineStylesheet,l=t.maskInputOptions,d=void 0===l?{}:l,p=t.maskTextFn,h=t.maskInputFn,f=t.recordCanvas,m=t.keepIframeSrcFn;if(i.__sn){var v=i.__sn.id;n=1===v?void 0:v}switch(e.nodeType){case e.DOCUMENT_NODE:return{type:K.Document,childNodes:[],rootId:n};case e.DOCUMENT_TYPE_NODE:return{type:K.DocumentType,name:e.name,publicId:e.publicId,systemId:e.systemId,rootId:n};case e.ELEMENT_NODE:for(var g=function(e,t,n){if("string"==typeof t){if(e.classList.contains(t))return!0}else for(var r=0;r<e.classList.length;r++){var i=e.classList[r];if(t.test(i))return!0}return!!n&&e.matches(n)}(e,o,a),b=function(e){if(e instanceof HTMLFormElement)return"form";var t=e.tagName.toLowerCase().trim();return ae.test(t)?"div":t}(e),y={},w=0,S=Array.from(e.attributes);w<S.length;w++){var k=S[w],C=k.name,I=k.value;y[C]=ge(i,b,C,I)}if("link"===b&&u){var T,E=Array.from(i.styleSheets).find((function(t){return t.href===e.href}));(T=se(E))&&(delete y.rel,delete y.href,y._cssText=pe(T,E.href))}if("style"===b&&e.sheet&&!(e.innerText||e.textContent||"").trim().length)(T=se(e.sheet))&&(y._cssText=pe(T,ve()));if("input"===b||"textarea"===b||"select"===b){I=e.value;"radio"!==y.type&&"checkbox"!==y.type&&"submit"!==y.type&&"button"!==y.type&&I?y.value=function(e){var t=e.maskInputOptions,n=e.tagName,r=e.type,i=e.value,o=e.maskInputFn,a=i||"";return(t[n.toLowerCase()]||t[r])&&(a=o?o(a):"*".repeat(a.length)),a}({type:y.type,tagName:b,value:I,maskInputOptions:d,maskInputFn:h}):e.checked&&(y.checked=e.checked)}if("option"===b){var _=e.parentElement;y.value===_.value&&(y.selected=e.selected)}if("canvas"===b&&f&&(y.rr_dataURL=e.toDataURL()),"audio"!==b&&"video"!==b||(y.rr_mediaState=e.paused?"paused":"played",y.rr_mediaCurrentTime=e.currentTime),e.scrollLeft&&(y.rr_scrollLeft=e.scrollLeft),e.scrollTop&&(y.rr_scrollTop=e.scrollTop),g){var x=e.getBoundingClientRect(),N=x.width,O=x.height;y={class:y.class,rr_width:N+"px",rr_height:O+"px"}}return"iframe"!==b||m(y.src)||delete y.src,{type:K.Element,tagName:b,attributes:y,childNodes:[],isSVG:(r=e,"svg"===r.tagName||r instanceof SVGElement||void 0),needBlock:g,rootId:n};case e.TEXT_NODE:var M=e.parentNode&&e.parentNode.tagName,L=e.textContent,D="STYLE"===M||void 0,R="SCRIPT"===M||void 0;return D&&L&&(L=pe(L,ve())),R&&(L="SCRIPT_PLACEHOLDER"),!D&&!R&&be(e,s,c)&&L&&(L=p?p(L):L.replace(/[\S]/g,"*")),{type:K.Text,textContent:L||"",isStyle:D,rootId:n};case e.CDATA_SECTION_NODE:return{type:K.CDATA,textContent:"",rootId:n};case e.COMMENT_NODE:return{type:K.Comment,textContent:e.textContent||"",rootId:n};default:return!1}}function we(e){return void 0===e?"":e.toLowerCase()}function Se(e,t){var n,r=t.doc,i=t.map,o=t.blockClass,a=t.blockSelector,s=t.maskTextClass,c=t.maskTextSelector,u=t.skipChild,l=void 0!==u&&u,d=t.inlineStylesheet,p=void 0===d||d,h=t.maskInputOptions,f=void 0===h?{}:h,m=t.maskTextFn,v=t.maskInputFn,g=t.slimDOMOptions,b=t.recordCanvas,y=void 0!==b&&b,w=t.onSerialize,S=t.onIframeLoad,k=t.iframeLoadTimeout,C=void 0===k?5e3:k,I=t.keepIframeSrcFn,T=void 0===I?function(){return!1}:I,E=t.preserveWhiteSpace,_=void 0===E||E,x=ye(e,{doc:r,blockClass:o,blockSelector:a,maskTextClass:s,maskTextSelector:c,inlineStylesheet:p,maskInputOptions:f,maskTextFn:m,maskInputFn:v,recordCanvas:y,keepIframeSrcFn:T});if(!x)return console.warn(e,"not serialized"),null;n="__sn"in e?e.__sn.id:!function(e,t){if(t.comment&&e.type===K.Comment)return!0;if(e.type===K.Element){if(t.script&&("script"===e.tagName||"link"===e.tagName&&"preload"===e.attributes.rel&&"script"===e.attributes.as||"link"===e.tagName&&"prefetch"===e.attributes.rel&&"string"==typeof e.attributes.href&&e.attributes.href.endsWith(".js")))return!0;if(t.headFavicon&&("link"===e.tagName&&"shortcut icon"===e.attributes.rel||"meta"===e.tagName&&(we(e.attributes.name).match(/^msapplication-tile(image|color)$/)||"application-name"===we(e.attributes.name)||"icon"===we(e.attributes.rel)||"apple-touch-icon"===we(e.attributes.rel)||"shortcut icon"===we(e.attributes.rel))))return!0;if("meta"===e.tagName){if(t.headMetaDescKeywords&&we(e.attributes.name).match(/^description|keywords$/))return!0;if(t.headMetaSocial&&(we(e.attributes.property).match(/^(og|twitter|fb):/)||we(e.attributes.name).match(/^(og|twitter):/)||"pinterest"===we(e.attributes.name)))return!0;if(t.headMetaRobots&&("robots"===we(e.attributes.name)||"googlebot"===we(e.attributes.name)||"bingbot"===we(e.attributes.name)))return!0;if(t.headMetaHttpEquiv&&void 0!==e.attributes["http-equiv"])return!0;if(t.headMetaAuthorship&&("author"===we(e.attributes.name)||"generator"===we(e.attributes.name)||"framework"===we(e.attributes.name)||"publisher"===we(e.attributes.name)||"progid"===we(e.attributes.name)||we(e.attributes.property).match(/^article:/)||we(e.attributes.property).match(/^product:/)))return!0;if(t.headMetaVerification&&("google-site-verification"===we(e.attributes.name)||"yandex-verification"===we(e.attributes.name)||"csrf-token"===we(e.attributes.name)||"p:domain_verify"===we(e.attributes.name)||"verify-v1"===we(e.attributes.name)||"verification"===we(e.attributes.name)||"shopify-checkout-api-token"===we(e.attributes.name)))return!0}}return!1}(x,g)&&(_||x.type!==K.Text||x.isStyle||x.textContent.replace(/^\s+|\s+$/gm,"").length)?oe++:-2;var N=Object.assign(x,{id:n});if(e.__sn=N,-2===n)return null;i[n]=e,w&&w(e);var O=!l;if(N.type===K.Element&&(O=O&&!N.needBlock,delete N.needBlock),(N.type===K.Document||N.type===K.Element)&&O){g.headWhitespace&&x.type===K.Element&&"head"===x.tagName&&(_=!1);for(var M={doc:r,map:i,blockClass:o,blockSelector:a,maskTextClass:s,maskTextSelector:c,skipChild:l,inlineStylesheet:p,maskInputOptions:f,maskTextFn:m,maskInputFn:v,slimDOMOptions:g,recordCanvas:y,preserveWhiteSpace:_,onSerialize:w,onIframeLoad:S,iframeLoadTimeout:C,keepIframeSrcFn:T},L=0,D=Array.from(e.childNodes);L<D.length;L++){(A=Se(D[L],M))&&N.childNodes.push(A)}if(re(e)&&e.shadowRoot){N.isShadowHost=!0;for(var R=0,P=Array.from(e.shadowRoot.childNodes);R<P.length;R++){var A;(A=Se(P[R],M))&&(A.isShadow=!0,N.childNodes.push(A))}}}return e.parentNode&&ie(e.parentNode)&&(N.isShadow=!0),N.type===K.Element&&"iframe"===N.tagName&&function(e,t,n){var r=e.contentWindow;if(r){var i,o=!1;try{i=r.document.readyState}catch(e){return}if("complete"===i){"about:blank"===r.location.href&&"about:blank"!==e.src&&""!==e.src?e.addEventListener("load",t):setTimeout(t,0)}else{var a=setTimeout((function(){o||(t(),o=!0)}),n);e.addEventListener("load",(function(){clearTimeout(a),o=!0,t()}))}}}(e,(function(){var t=e.contentDocument;if(t&&S){var n=Se(t,{doc:t,map:i,blockClass:o,blockSelector:a,maskTextClass:s,maskTextSelector:c,skipChild:!1,inlineStylesheet:p,maskInputOptions:f,maskTextFn:m,maskInputFn:v,slimDOMOptions:g,recordCanvas:y,preserveWhiteSpace:_,onSerialize:w,onIframeLoad:S,iframeLoadTimeout:C,keepIframeSrcFn:T});n&&S(e,n)}}),C),N}var ke,Ce,Ie,Te,Ee,_e=/([^\\]):hover/;new RegExp(_e,"g");function xe(e,t,n){void 0===n&&(n=document);var r={capture:!0,passive:!0};return n.addEventListener(e,t,r),function(){return n.removeEventListener(e,t,r)}}!function(e){e[e.DomContentLoaded=0]="DomContentLoaded",e[e.Load=1]="Load",e[e.FullSnapshot=2]="FullSnapshot",e[e.IncrementalSnapshot=3]="IncrementalSnapshot",e[e.Meta=4]="Meta",e[e.Custom=5]="Custom"}(ke||(ke={})),function(e){e[e.Mutation=0]="Mutation",e[e.MouseMove=1]="MouseMove",e[e.MouseInteraction=2]="MouseInteraction",e[e.Scroll=3]="Scroll",e[e.ViewportResize=4]="ViewportResize",e[e.Input=5]="Input",e[e.TouchMove=6]="TouchMove",e[e.MediaInteraction=7]="MediaInteraction",e[e.StyleSheetRule=8]="StyleSheetRule",e[e.CanvasMutation=9]="CanvasMutation",e[e.Font=10]="Font",e[e.Log=11]="Log",e[e.Drag=12]="Drag"}(Ce||(Ce={})),function(e){e[e.MouseUp=0]="MouseUp",e[e.MouseDown=1]="MouseDown",e[e.Click=2]="Click",e[e.ContextMenu=3]="ContextMenu",e[e.DblClick=4]="DblClick",e[e.Focus=5]="Focus",e[e.Blur=6]="Blur",e[e.TouchStart=7]="TouchStart",e[e.TouchMove_Departed=8]="TouchMove_Departed",e[e.TouchEnd=9]="TouchEnd"}(Ie||(Ie={})),function(e){e[e.Play=0]="Play",e[e.Pause=1]="Pause"}(Te||(Te={})),function(e){e.Start="start",e.Pause="pause",e.Resume="resume",e.Resize="resize",e.Finish="finish",e.FullsnapshotRebuilded="fullsnapshot-rebuilded",e.LoadStylesheetStart="load-stylesheet-start",e.LoadStylesheetEnd="load-stylesheet-end",e.SkipStart="skip-start",e.SkipEnd="skip-end",e.MouseInteraction="mouse-interaction",e.EventCast="event-cast",e.CustomEvent="custom-event",e.Flush="flush",e.StateChange="state-change",e.PlayBack="play-back"}(Ee||(Ee={}));var Ne="Please stop import mirror directly. Instead of that,\r\nnow you can use replayer.getMirror() to access the mirror instance of a replayer,\r\nor you can use record.mirror to access the mirror instance during recording.",Oe={map:{},getId:function(){return console.error(Ne),-1},getNode:function(){return console.error(Ne),null},removeNodeFromMap:function(){console.error(Ne)},has:function(){return console.error(Ne),!1},reset:function(){console.error(Ne)}};function Me(e,t,n){void 0===n&&(n={});var r=null,i=0;return function(o){var a=Date.now();i||!1!==n.leading||(i=a);var s=t-(a-i),c=this,u=arguments;s<=0||s>t?(r&&(window.clearTimeout(r),r=null),i=a,e.apply(c,u)):r||!1===n.trailing||(r=window.setTimeout((function(){i=!1===n.leading?0:Date.now(),r=null,e.apply(c,u)}),s))}}function Le(e,t,n,r,i){void 0===i&&(i=window);var o=i.Object.getOwnPropertyDescriptor(e,t);return i.Object.defineProperty(e,t,r?n:{set:function(e){var t=this;setTimeout((function(){n.set.call(t,e)}),0),o&&o.set&&o.set.call(this,e)}}),function(){return Le(e,t,o||{},!0)}}function De(e,t,n){try{if(!(t in e))return function(){};var r=e[t],i=n(r);return"function"==typeof i&&(i.prototype=i.prototype||{},Object.defineProperties(i,{__rrweb_original__:{enumerable:!1,value:r}})),e[t]=i,function(){e[t]=r}}catch(e){return function(){}}}function Re(){return window.innerHeight||document.documentElement&&document.documentElement.clientHeight||document.body&&document.body.clientHeight}function Pe(){return window.innerWidth||document.documentElement&&document.documentElement.clientWidth||document.body&&document.body.clientWidth}function Ae(e,t){if(!e)return!1;if(e.nodeType===e.ELEMENT_NODE){var n=!1;return"string"==typeof t?n=e.classList.contains(t):e.classList.forEach((function(e){t.test(e)&&(n=!0)})),n||Ae(e.parentNode,t)}return e.nodeType,e.TEXT_NODE,Ae(e.parentNode,t)}function Fe(e){return"__sn"in e&&-2===e.__sn.id}function Ve(e){return Boolean(e.changedTouches)}"undefined"!=typeof window&&window.Proxy&&window.Reflect&&(Oe=new Proxy(Oe,{get:function(e,t,n){return"map"===t&&console.error(Ne),Reflect.get(e,t,n)}}));!function(){function e(){this.reset()}e.prototype.add=function(e){var t=this.indexes.get(e.parentId),n={id:e.node.id,mutation:e,children:[],texts:[],attributes:[]};t?(n.parent=t,t.children[n.id]=n):this.tree[n.id]=n,this.indexes.set(n.id,n)},e.prototype.remove=function(e,t){var n=this,r=this.indexes.get(e.parentId),i=this.indexes.get(e.id),o=function(e){n.removeIdSet.add(e);var r=t.getNode(e);null==r||r.childNodes.forEach((function(e){"__sn"in e&&o(e.__sn.id)}))},a=function(t){n.removeIdSet.add(t.id),Object.values(t.children).forEach((function(e){return a(e)}));var r=n.indexes.get(t.id);if(r){var i=r.parent;i&&(delete r.parent,delete i.children[r.id],n.indexes.delete(e.id))}};i?r?(delete i.parent,delete r.children[i.id],this.indexes.delete(e.id),a(i)):(delete this.tree[i.id],this.indexes.delete(i.id),a(i)):(this.removeNodeMutations.push(e),o(e.id))},e.prototype.text=function(e){var t=this.indexes.get(e.id);t?t.texts.push(e):this.textMutations.push(e)},e.prototype.attribute=function(e){var t=this.indexes.get(e.id);t?t.attributes.push(e):this.attributeMutations.push(e)},e.prototype.scroll=function(e){this.scrollMap.set(e.id,e)},e.prototype.input=function(e){this.inputMap.set(e.id,e)},e.prototype.flush=function(){var e,t,n,r,i=this,o=this.tree,a=this.removeNodeMutations,s=this.textMutations,c=this.attributeMutations,u={source:Ce.Mutation,removes:a,texts:s,attributes:c,adds:[]},l=function(e,t){t&&i.removeIdSet.add(e.id),u.texts=u.texts.concat(t?[]:e.texts).filter((function(e){return!i.removeIdSet.has(e.id)})),u.attributes=u.attributes.concat(t?[]:e.attributes).filter((function(e){return!i.removeIdSet.has(e.id)})),i.removeIdSet.has(e.id)||i.removeIdSet.has(e.mutation.parentId)||t?Object.values(e.children).forEach((function(e){return l(e,!0)})):(u.adds.push(e.mutation),e.children&&Object.values(e.children).forEach((function(e){return l(e,!1)})))};Object.values(o).forEach((function(e){return l(e,!1)}));try{for(var d=ee(this.scrollMap.keys()),p=d.next();!p.done;p=d.next()){var h=p.value;this.removeIdSet.has(h)&&this.scrollMap.delete(h)}}catch(t){e={error:t}}finally{try{p&&!p.done&&(t=d.return)&&t.call(d)}finally{if(e)throw e.error}}try{for(var f=ee(this.inputMap.keys()),m=f.next();!m.done;m=f.next()){h=m.value;this.removeIdSet.has(h)&&this.inputMap.delete(h)}}catch(e){n={error:e}}finally{try{m&&!m.done&&(r=f.return)&&r.call(f)}finally{if(n)throw n.error}}var v=new Map(this.scrollMap),g=new Map(this.inputMap);return this.reset(),{mutationData:u,scrollMap:v,inputMap:g}},e.prototype.reset=function(){this.tree=[],this.indexes=new Map,this.removeNodeMutations=[],this.textMutations=[],this.attributeMutations=[],this.removeIdSet=new Set,this.scrollMap=new Map,this.inputMap=new Map}}();function je(e){return"__sn"in e&&(e.__sn.type===K.Element&&"iframe"===e.__sn.tagName)}function $e(e){var t;return Boolean(null===(t=e)||void 0===t?void 0:t.shadowRoot)}function ze(e){return"__ln"in e}var qe=function(){function e(){this.length=0,this.head=null}return e.prototype.get=function(e){if(e>=this.length)throw new Error("Position outside of list range");for(var t=this.head,n=0;n<e;n++)t=(null==t?void 0:t.next)||null;return t},e.prototype.addNode=function(e){var t={value:e,previous:null,next:null};if(e.__ln=t,e.previousSibling&&ze(e.previousSibling)){var n=e.previousSibling.__ln.next;t.next=n,t.previous=e.previousSibling.__ln,e.previousSibling.__ln.next=t,n&&(n.previous=t)}else if(e.nextSibling&&ze(e.nextSibling)&&e.nextSibling.__ln.previous){n=e.nextSibling.__ln.previous;t.previous=n,t.next=e.nextSibling.__ln,e.nextSibling.__ln.previous=t,n&&(n.next=t)}else this.head&&(this.head.previous=t),t.next=this.head,this.head=t;this.length++},e.prototype.removeNode=function(e){var t=e.__ln;this.head&&(t.previous?(t.previous.next=t.next,t.next&&(t.next.previous=t.previous)):(this.head=t.next,this.head&&(this.head.previous=null)),e.__ln&&delete e.__ln,this.length--)},e}(),Ue=function(e,t){return e+"@"+t};function Be(e){return"__sn"in e}function He(e,t){e.delete(t),t.childNodes.forEach((function(t){return He(e,t)}))}function We(e,t,n){var r=t.parentNode;if(!r)return!1;var i=n.getId(r);return!!e.some((function(e){return e.id===i}))||We(e,r,n)}function Qe(e,t){var n=t.parentNode;return!!n&&(!!e.has(n)||Qe(e,n))}var Je=function(){function e(){var e=this;this.frozen=!1,this.locked=!1,this.texts=[],this.attributes=[],this.removes=[],this.mapRemoves=[],this.movedMap={},this.addedSet=new Set,this.movedSet=new Set,this.droppedSet=new Set,this.processMutations=function(t){t.forEach(e.processMutation),e.emit()},this.emit=function(){var t,n,r,i;if(!e.frozen&&!e.locked){for(var o=[],a=new qe,s=function(t){for(var n=t,r=-2;-2===r;)r=(n=n&&n.nextSibling)&&e.mirror.getId(n);return-1===r&&Ae(t.nextSibling,e.blockClass)&&(r=null),r},c=function(t){var n,r=t.getRootNode?null===(n=t.getRootNode())||void 0===n?void 0:n.host:null,i=!(e.doc.contains(t)||r instanceof Node&&e.doc.contains(r));if(t.parentNode&&!i){var c=ie(t.parentNode)?e.mirror.getId(r):e.mirror.getId(t.parentNode),u=s(t);if(-1===c||-1===u)return a.addNode(t);var l=Se(t,{doc:e.doc,map:e.mirror.map,blockClass:e.blockClass,blockSelector:e.blockSelector,maskTextClass:e.maskTextClass,maskTextSelector:e.maskTextSelector,skipChild:!0,inlineStylesheet:e.inlineStylesheet,maskInputOptions:e.maskInputOptions,maskTextFn:e.maskTextFn,slimDOMOptions:e.slimDOMOptions,recordCanvas:e.recordCanvas,onSerialize:function(n){je(n)&&e.iframeManager.addIframe(n),$e(t)&&e.shadowDomManager.addShadowRoot(t.shadowRoot,document)},onIframeLoad:function(t,n){e.iframeManager.attachIframe(t,n)}});l&&o.push({parentId:c,nextId:u,node:l})}};e.mapRemoves.length;)e.mirror.removeNodeFromMap(e.mapRemoves.shift());try{for(var u=ee(e.movedSet),l=u.next();!l.done;l=u.next()){var d=l.value;We(e.removes,d,e.mirror)&&!e.movedSet.has(d.parentNode)||c(d)}}catch(e){t={error:e}}finally{try{l&&!l.done&&(n=u.return)&&n.call(u)}finally{if(t)throw t.error}}try{for(var p=ee(e.addedSet),h=p.next();!h.done;h=p.next()){d=h.value;Qe(e.droppedSet,d)||We(e.removes,d,e.mirror)?Qe(e.movedSet,d)?c(d):e.droppedSet.add(d):c(d)}}catch(e){r={error:e}}finally{try{h&&!h.done&&(i=p.return)&&i.call(p)}finally{if(r)throw r.error}}for(var f=null;a.length;){var m=null;if(f){var v=e.mirror.getId(f.value.parentNode),g=s(f.value);-1!==v&&-1!==g&&(m=f)}if(!m)for(var b=a.length-1;b>=0;b--){var y=a.get(b);if(y){v=e.mirror.getId(y.value.parentNode),g=s(y.value);if(-1!==v&&-1!==g){m=y;break}}}if(!m){for(;a.head;)a.removeNode(a.head.value);break}f=m.previous,a.removeNode(m.value),c(m.value)}var w={texts:e.texts.map((function(t){return{id:e.mirror.getId(t.node),value:t.value}})).filter((function(t){return e.mirror.has(t.id)})),attributes:e.attributes.map((function(t){return{id:e.mirror.getId(t.node),attributes:t.attributes}})).filter((function(t){return e.mirror.has(t.id)})),removes:e.removes,adds:o};(w.texts.length||w.attributes.length||w.removes.length||w.adds.length)&&(e.texts=[],e.attributes=[],e.removes=[],e.addedSet=new Set,e.movedSet=new Set,e.droppedSet=new Set,e.movedMap={},e.emissionCallback(w))}},this.processMutation=function(t){if(!Fe(t.target))switch(t.type){case"characterData":var n=t.target.textContent;Ae(t.target,e.blockClass)||n===t.oldValue||e.texts.push({value:be(t.target,e.maskTextClass,e.maskTextSelector)&&n?e.maskTextFn?e.maskTextFn(n):n.replace(/[\S]/g,"*"):n,node:t.target});break;case"attributes":n=t.target.getAttribute(t.attributeName);if(Ae(t.target,e.blockClass)||n===t.oldValue)return;var r=e.attributes.find((function(e){return e.node===t.target}));r||(r={node:t.target,attributes:{}},e.attributes.push(r)),r.attributes[t.attributeName]=ge(e.doc,t.target.tagName,t.attributeName,n);break;case"childList":t.addedNodes.forEach((function(n){return e.genAdds(n,t.target)})),t.removedNodes.forEach((function(n){var r=e.mirror.getId(n),i=ie(t.target)?e.mirror.getId(t.target.host):e.mirror.getId(t.target);Ae(n,e.blockClass)||Ae(t.target,e.blockClass)||Fe(n)||(e.addedSet.has(n)?(He(e.addedSet,n),e.droppedSet.add(n)):e.addedSet.has(t.target)&&-1===r||function e(t,n){if(ie(t))return!1;var r=n.getId(t);return!n.has(r)||(!t.parentNode||t.parentNode.nodeType!==t.DOCUMENT_NODE)&&(!t.parentNode||e(t.parentNode,n))}(t.target,e.mirror)||(e.movedSet.has(n)&&e.movedMap[Ue(r,i)]?He(e.movedSet,n):e.removes.push({parentId:i,id:r,isShadow:!!ie(t.target)||void 0})),e.mapRemoves.push(n))}))}},this.genAdds=function(t,n){if(!(Ae(t,e.blockClass)||n&&Ae(n,e.blockClass))){if(Be(t)){if(Fe(t))return;e.movedSet.add(t);var r=null;n&&Be(n)&&(r=n.__sn.id),r&&(e.movedMap[Ue(t.__sn.id,r)]=!0)}else e.addedSet.add(t),e.droppedSet.delete(t);t.childNodes.forEach((function(t){return e.genAdds(t)}))}}}return e.prototype.init=function(e,t,n,r,i,o,a,s,c,u,l,d,p,h){this.blockClass=t,this.blockSelector=n,this.maskTextClass=r,this.maskTextSelector=i,this.inlineStylesheet=o,this.maskInputOptions=a,this.maskTextFn=s,this.recordCanvas=c,this.slimDOMOptions=u,this.emissionCallback=e,this.doc=l,this.mirror=d,this.iframeManager=p,this.shadowDomManager=h},e.prototype.freeze=function(){this.frozen=!0},e.prototype.unfreeze=function(){this.frozen=!1,this.emit()},e.prototype.isFrozen=function(){return this.frozen},e.prototype.lock=function(){this.locked=!0},e.prototype.unlock=function(){this.locked=!1,this.emit()},e}();function Xe(e){if(!e||!e.outerHTML)return"";for(var t="";e.parentElement;){var n=e.localName;if(!n)break;n=n.toLowerCase();var r=e.parentElement,i=[];if(r.children&&r.children.length>0)for(var o=0;o<r.children.length;o++){var a=r.children[o];a.localName&&a.localName.toLowerCase&&a.localName.toLowerCase()===n&&i.push(a)}i.length>1&&(n+=":eq("+i.indexOf(e)+")"),t=n+(t?">"+t:""),e=r}return t}function Ye(e,t){var n={numOfKeysLimit:50};Object.assign(n,t);var r=[],i=[];return JSON.stringify(e,(function(e,t){if(r.length>0){var o=r.indexOf(this);~o?r.splice(o+1):r.push(this),~o?i.splice(o,1/0,e):i.push(e),~r.indexOf(t)&&(t=r[0]===t?"[Circular ~]":"[Circular ~."+i.slice(0,r.indexOf(t)).join(".")+"]")}else r.push(t);if(null==t)return t;if(function(e){if("object"==typeof e&&Object.keys(e).length>n.numOfKeysLimit)return!0;if("function"==typeof e)return!0;return!1}(t))return function(e){var t=e.toString();n.stringLengthLimit&&t.length>n.stringLengthLimit&&(t=t.slice(0,n.stringLengthLimit)+"...");return t}(t);if(t instanceof Event){var a={};for(var s in t){var c=t[s];Array.isArray(c)?a[s]=Xe(c.length?c[0]:null):a[s]=c}return a}return t instanceof Node?t instanceof HTMLElement?t?t.outerHTML:"":t.nodeName:t}))}var Ge=function(){function e(e){this.fileName=e.fileName||"",this.functionName=e.functionName||"",this.lineNumber=e.lineNumber,this.columnNumber=e.columnNumber}return e.prototype.toString=function(){var e=this.lineNumber||"",t=this.columnNumber||"";return this.functionName?this.functionName+" ("+this.fileName+":"+e+":"+t+")":this.fileName+":"+e+":"+t},e}(),Ke=/(^|@)\S+:\d+/,Ze=/^\s*at .*(\S+:\d+|\(native\))/m,et=/^(eval@)?(\[native code])?$/,tt={parse:function(e){if(void 0!==e.stacktrace||void 0!==e["opera#sourceloc"])return this.parseOpera(e);if(e.stack&&e.stack.match(Ze))return this.parseV8OrIE(e);if(e.stack)return this.parseFFOrSafari(e);throw new Error("Cannot parse given Error object")},extractLocation:function(e){if(-1===e.indexOf(":"))return[e];var t=/(.+?)(?::(\d+))?(?::(\d+))?$/.exec(e.replace(/[()]/g,""));if(!t)throw new Error("Cannot parse given url: "+e);return[t[1],t[2]||void 0,t[3]||void 0]},parseV8OrIE:function(e){return e.stack.split("\n").filter((function(e){return!!e.match(Ze)}),this).map((function(e){e.indexOf("(eval ")>-1&&(e=e.replace(/eval code/g,"eval").replace(/(\(eval at [^()]*)|(\),.*$)/g,""));var t=e.replace(/^\s+/,"").replace(/\(eval code/g,"("),n=t.match(/ (\((.+):(\d+):(\d+)\)$)/),r=(t=n?t.replace(n[0],""):t).split(/\s+/).slice(1),i=this.extractLocation(n?n[1]:r.pop()),o=r.join(" ")||void 0,a=["eval","<anonymous>"].indexOf(i[0])>-1?void 0:i[0];return new Ge({functionName:o,fileName:a,lineNumber:i[1],columnNumber:i[2]})}),this)},parseFFOrSafari:function(e){return e.stack.split("\n").filter((function(e){return!e.match(et)}),this).map((function(e){if(e.indexOf(" > eval")>-1&&(e=e.replace(/ line (\d+)(?: > eval line \d+)* > eval:\d+:\d+/g,":$1")),-1===e.indexOf("@")&&-1===e.indexOf(":"))return new Ge({functionName:e});var t=/((.*".+"[^@]*)?[^@]*)(?:@)/,n=e.match(t),r=n&&n[1]?n[1]:void 0,i=this.extractLocation(e.replace(t,""));return new Ge({functionName:r,fileName:i[0],lineNumber:i[1],columnNumber:i[2]})}),this)},parseOpera:function(e){return!e.stacktrace||e.message.indexOf("\n")>-1&&e.message.split("\n").length>e.stacktrace.split("\n").length?this.parseOpera9(e):e.stack?this.parseOpera11(e):this.parseOpera10(e)},parseOpera9:function(e){for(var t=/Line (\d+).*script (?:in )?(\S+)/i,n=e.message.split("\n"),r=[],i=2,o=n.length;i<o;i+=2){var a=t.exec(n[i]);a&&r.push(new Ge({fileName:a[2],lineNumber:parseFloat(a[1])}))}return r},parseOpera10:function(e){for(var t=/Line (\d+).*script (?:in )?(\S+)(?:: In function (\S+))?$/i,n=e.stacktrace.split("\n"),r=[],i=0,o=n.length;i<o;i+=2){var a=t.exec(n[i]);a&&r.push(new Ge({functionName:a[3]||void 0,fileName:a[2],lineNumber:parseFloat(a[1])}))}return r},parseOpera11:function(e){return e.stack.split("\n").filter((function(e){return!!e.match(Ke)&&!e.match(/^Error created at/)}),this).map((function(e){var t=e.split("@"),n=this.extractLocation(t.pop()),r=(t.shift()||"").replace(/<anonymous function(: (\w+))?>/,"$2").replace(/\([^)]*\)/g,"")||void 0;return new Ge({functionName:r,fileName:n[0],lineNumber:n[1],columnNumber:n[2]})}),this)}},nt=[];function rt(e){try{if("composedPath"in e){var t=e.composedPath();if(t.length)return t[0]}else if("path"in e&&e.path.length)return e.path[0];return e.target}catch(t){return e.target}}function it(e,t,n,r,i,o,a,s,c,u,l,d,p,h,f){var m,v,g,b=new Je;nt.push(b),b.init(e,n,r,i,o,a,s,c,u,l,t,d,p,h);var y=window.MutationObserver||window.__rrMutationObserver,w=null===(g=null===(v=null===(m=window)||void 0===m?void 0:m.Zone)||void 0===v?void 0:v.__symbol__)||void 0===g?void 0:g.call(v,"MutationObserver");w&&window[w]&&(y=window[w]);var S=new y(b.processMutations.bind(b));return S.observe(f,{attributes:!0,attributeOldValue:!0,characterData:!0,characterDataOldValue:!0,childList:!0,subtree:!0}),S}function ot(e,t,n,r,i){if(!1===i.mouseInteraction)return function(){};var o=!0===i.mouseInteraction||void 0===i.mouseInteraction?{}:i.mouseInteraction,a=[];return Object.keys(Ie).filter((function(e){return Number.isNaN(Number(e))&&!e.endsWith("_Departed")&&!1!==o[e]})).forEach((function(i){var o=i.toLowerCase(),s=function(t){return function(i){var o=rt(i);if(!Ae(o,r)){var a=Ve(i)?i.changedTouches[0]:i;if(a){var s=n.getId(o),c=a.clientX,u=a.clientY;e({type:Ie[t],id:s,x:c,y:u})}}}}(i);a.push(xe(o,s,t))})),function(){a.forEach((function(e){return e()}))}}function at(e,t,n,r,i){return xe("scroll",Me((function(i){var o=rt(i);if(o&&!Ae(o,r)){var a=n.getId(o);if(o===t){var s=t.scrollingElement||t.documentElement;e({id:a,x:s.scrollLeft,y:s.scrollTop})}else e({id:a,x:o.scrollLeft,y:o.scrollTop})}}),i.scroll||100),t)}var st=["INPUT","TEXTAREA","SELECT"],ct=new WeakMap;function ut(e,t){void 0===t&&(t={}),function(e,t){var n=e.mutationCb,r=e.mousemoveCb,i=e.mouseInteractionCb,o=e.scrollCb,a=e.viewportResizeCb,s=e.inputCb,c=e.mediaInteractionCb,u=e.styleSheetRuleCb,l=e.canvasMutationCb,d=e.fontCb,p=e.logCb;e.mutationCb=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];t.mutation&&t.mutation.apply(t,ne(e)),n.apply(void 0,ne(e))},e.mousemoveCb=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];t.mousemove&&t.mousemove.apply(t,ne(e)),r.apply(void 0,ne(e))},e.mouseInteractionCb=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];t.mouseInteraction&&t.mouseInteraction.apply(t,ne(e)),i.apply(void 0,ne(e))},e.scrollCb=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];t.scroll&&t.scroll.apply(t,ne(e)),o.apply(void 0,ne(e))},e.viewportResizeCb=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];t.viewportResize&&t.viewportResize.apply(t,ne(e)),a.apply(void 0,ne(e))},e.inputCb=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];t.input&&t.input.apply(t,ne(e)),s.apply(void 0,ne(e))},e.mediaInteractionCb=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];t.mediaInteaction&&t.mediaInteaction.apply(t,ne(e)),c.apply(void 0,ne(e))},e.styleSheetRuleCb=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];t.styleSheetRule&&t.styleSheetRule.apply(t,ne(e)),u.apply(void 0,ne(e))},e.canvasMutationCb=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];t.canvasMutation&&t.canvasMutation.apply(t,ne(e)),l.apply(void 0,ne(e))},e.fontCb=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];t.font&&t.font.apply(t,ne(e)),d.apply(void 0,ne(e))},e.logCb=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];t.log&&t.log.apply(t,ne(e)),p.apply(void 0,ne(e))}}(e,t);var n,r,i,o,a,s,c,u,l=it(e.mutationCb,e.doc,e.blockClass,e.blockSelector,e.maskTextClass,e.maskTextSelector,e.inlineStylesheet,e.maskInputOptions,e.maskTextFn,e.recordCanvas,e.slimDOMOptions,e.mirror,e.iframeManager,e.shadowDomManager,e.doc),d=function(e,t,n,r){if(!1===t.mousemove)return function(){};var i,o="number"==typeof t.mousemove?t.mousemove:50,a="number"==typeof t.mousemoveCallback?t.mousemoveCallback:500,s=[],c=Me((function(t){var n=Date.now()-i;e(s.map((function(e){return e.timeOffset-=n,e})),t),s=[],i=null}),a);function u(e){var t=rt(e),n=Ve(e)?e.changedTouches[0]:e,o=n.clientX,a=n.clientY;i||(i=Date.now()),s.push({x:o,y:a,id:r.getId(t),timeOffset:Date.now()-i})}var l=Me((function(e){u(e),c(e instanceof MouseEvent?Ce.MouseMove:Ce.TouchMove)}),o,{trailing:!1}),d=Me((function(e){u(e),c(e instanceof DragEvent?Ce.Drag:e instanceof MouseEvent?Ce.MouseMove:Ce.TouchMove)}),o,{trailing:!1}),p="undefined"!=typeof DragEvent,h=[xe("mousemove",l,n),xe("touchmove",l,n),xe("drag",p?d:l,n)];return function(){h.forEach((function(e){return e()}))}}(e.mousemoveCb,e.sampling,e.doc,e.mirror),p=ot(e.mouseInteractionCb,e.doc,e.mirror,e.blockClass,e.sampling),h=at(e.scrollCb,e.doc,e.mirror,e.blockClass,e.sampling),f=(n=e.viewportResizeCb,r=-1,i=-1,xe("resize",Me((function(){var e=Re(),t=Pe();r===e&&i===t||(n({width:Number(t),height:Number(e)}),r=e,i=t)}),200),window)),m=function(e,t,n,r,i,o,a,s){function c(e){var n=rt(e);if(n&&n.tagName&&!(st.indexOf(n.tagName)<0)&&!Ae(n,r)){var s=n.type;if(!n.classList.contains(i)){var c=n.value,l=!1;"radio"===s||"checkbox"===s?l=n.checked:(o[n.tagName.toLowerCase()]||o[s])&&(c=a?a(c):"*".repeat(c.length)),u(n,{text:c,isChecked:l});var d=n.name;"radio"===s&&d&&l&&t.querySelectorAll('input[type="radio"][name="'+d+'"]').forEach((function(e){e!==n&&u(e,{text:e.value,isChecked:!l})}))}}}function u(t,r){var i=ct.get(t);if(!i||i.text!==r.text||i.isChecked!==r.isChecked){ct.set(t,r);var o=n.getId(t);e(Z(Z({},r),{id:o}))}}var l=("last"===s.input?["change"]:["input","change"]).map((function(e){return xe(e,c,t)})),d=Object.getOwnPropertyDescriptor(HTMLInputElement.prototype,"value"),p=[[HTMLInputElement.prototype,"value"],[HTMLInputElement.prototype,"checked"],[HTMLSelectElement.prototype,"value"],[HTMLTextAreaElement.prototype,"value"],[HTMLSelectElement.prototype,"selectedIndex"]];return d&&d.set&&l.push.apply(l,ne(p.map((function(e){return Le(e[0],e[1],{set:function(){c({target:this})}})})))),function(){l.forEach((function(e){return e()}))}}(e.inputCb,e.doc,e.mirror,e.blockClass,e.ignoreClass,e.maskInputOptions,e.maskInputFn,e.sampling),v=(o=e.mediaInteractionCb,a=e.blockClass,s=e.mirror,u=[xe("play",(c=function(e){return function(t){var n=rt(t);n&&!Ae(n,a)&&o({type:"play"===e?Te.Play:Te.Pause,id:s.getId(n)})}})("play")),xe("pause",c("pause"))],function(){u.forEach((function(e){return e()}))}),g=function(e,t){var n=CSSStyleSheet.prototype.insertRule;CSSStyleSheet.prototype.insertRule=function(r,i){var o=t.getId(this.ownerNode);return-1!==o&&e({id:o,adds:[{rule:r,index:i}]}),n.apply(this,arguments)};var r=CSSStyleSheet.prototype.deleteRule;return CSSStyleSheet.prototype.deleteRule=function(n){var i=t.getId(this.ownerNode);return-1!==i&&e({id:i,removes:[{index:n}]}),r.apply(this,arguments)},function(){CSSStyleSheet.prototype.insertRule=n,CSSStyleSheet.prototype.deleteRule=r}}(e.styleSheetRuleCb,e.mirror),b=e.recordCanvas?function(e,t,n){var r,i,o=Object.getOwnPropertyNames(CanvasRenderingContext2D.prototype),a=[],s=function(r){try{if("function"!=typeof CanvasRenderingContext2D.prototype[r])return"continue";var i=De(CanvasRenderingContext2D.prototype,r,(function(i){return function(){for(var o=this,a=[],s=0;s<arguments.length;s++)a[s]=arguments[s];return Ae(this.canvas,t)||setTimeout((function(){var t=ne(a);if("drawImage"===r&&t[0]&&t[0]instanceof HTMLCanvasElement){var i=t[0],s=i.getContext("2d"),c=null==s?void 0:s.getImageData(0,0,i.width,i.height),u=null==c?void 0:c.data;t[0]=JSON.stringify(u)}e({id:n.getId(o.canvas),property:r,args:t})}),0),i.apply(this,a)}}));a.push(i)}catch(t){var o=Le(CanvasRenderingContext2D.prototype,r,{set:function(t){e({id:n.getId(this.canvas),property:r,args:[t],setter:!0})}});a.push(o)}};try{for(var c=ee(o),u=c.next();!u.done;u=c.next()){s(u.value)}}catch(e){r={error:e}}finally{try{u&&!u.done&&(i=c.return)&&i.call(c)}finally{if(r)throw r.error}}return function(){a.forEach((function(e){return e()}))}}(e.canvasMutationCb,e.blockClass,e.mirror):function(){},y=e.collectFonts?function(e){var t=[],n=new WeakMap,r=FontFace;window.FontFace=function(e,t,i){var o=new r(e,t,i);return n.set(o,{family:e,buffer:"string"!=typeof t,descriptors:i,fontSource:"string"==typeof t?t:JSON.stringify(Array.from(new Uint8Array(t)))}),o};var i=De(document.fonts,"add",(function(t){return function(r){return setTimeout((function(){var t=n.get(r);t&&(e(t),n.delete(r))}),0),t.apply(this,[r])}}));return t.push((function(){window.FonFace=r})),t.push(i),function(){t.forEach((function(e){return e()}))}}(e.fontCb):function(){},w=e.logOptions?function(e,t){var n,r,i=this,o=t.logger;if(!o)return function(){};var a=0,s=[];if(t.level.includes("error")&&window){var c=window.onerror;window.onerror=function(n,r,o,a,s){c&&c.apply(i,[n,r,o,a,s]);var u=tt.parse(s).map((function(e){return e.toString()})),l=[Ye(n,t.stringifyOptions)];e({level:"error",trace:u,payload:l})},s.push((function(){window.onerror=c}))}try{for(var u=ee(t.level),l=u.next();!l.done;l=u.next()){var d=l.value;s.push(p(o,d))}}catch(e){n={error:e}}finally{try{l&&!l.done&&(r=u.return)&&r.call(u)}finally{if(n)throw n.error}}return function(){s.forEach((function(e){return e()}))};function p(n,r){var i=this;return n[r]?De(n,r,(function(n){return function(){for(var o=[],s=0;s<arguments.length;s++)o[s]=arguments[s];n.apply(i,o);try{var c=tt.parse(new Error).map((function(e){return e.toString()})).splice(1),u=o.map((function(e){return Ye(e,t.stringifyOptions)}));++a<t.lengthThreshold?e({level:r,trace:c,payload:u}):a===t.lengthThreshold&&e({level:"warn",trace:[],payload:[Ye("The number of log records reached the threshold.")]})}catch(e){n.apply(void 0,ne(["rrweb logger error:",e],o))}}})):function(){}}}(e.logCb,e.logOptions):function(){};return function(){l.disconnect(),d(),p(),h(),f(),m(),v(),g(),b(),y(),w()}}var lt,dt,pt=function(){function e(e){this.iframes=new WeakMap,this.mutationCb=e.mutationCb}return e.prototype.addIframe=function(e){this.iframes.set(e,!0)},e.prototype.addLoadListener=function(e){this.loadListener=e},e.prototype.attachIframe=function(e,t){var n;this.mutationCb({adds:[{parentId:e.__sn.id,nextId:null,node:t}],removes:[],texts:[],attributes:[],isAttachIframe:!0}),null===(n=this.loadListener)||void 0===n||n.call(this,e)},e}(),ht=function(){function e(e){this.mutationCb=e.mutationCb,this.scrollCb=e.scrollCb,this.bypassOptions=e.bypassOptions,this.mirror=e.mirror}return e.prototype.addShadowRoot=function(e,t){it(this.mutationCb,t,this.bypassOptions.blockClass,this.bypassOptions.blockSelector,this.bypassOptions.maskTextClass,this.bypassOptions.maskTextSelector,this.bypassOptions.inlineStylesheet,this.bypassOptions.maskInputOptions,this.bypassOptions.maskTextFn,this.bypassOptions.recordCanvas,this.bypassOptions.slimDOMOptions,this.mirror,this.bypassOptions.iframeManager,this,e),at(this.scrollCb,e,this.mirror,this.bypassOptions.blockClass,this.bypassOptions.sampling)},e}();function ft(e){return Z(Z({},e),{timestamp:Date.now()})}var mt={map:{},getId:function(e){return e.__sn?e.__sn.id:-1},getNode:function(e){return this.map[e]||null},removeNodeFromMap:function(e){var t=this,n=e.__sn&&e.__sn.id;delete this.map[n],e.childNodes&&e.childNodes.forEach((function(e){return t.removeNodeFromMap(e)}))},has:function(e){return this.map.hasOwnProperty(e)},reset:function(){this.map={}}};function vt(e){void 0===e&&(e={});var t=e.emit,n=e.checkoutEveryNms,r=e.checkoutEveryNth,i=e.blockClass,o=void 0===i?"rr-block":i,a=e.blockSelector,s=void 0===a?null:a,c=e.ignoreClass,u=void 0===c?"rr-ignore":c,l=e.maskTextClass,d=void 0===l?"rr-mask":l,p=e.maskTextSelector,h=void 0===p?null:p,f=e.inlineStylesheet,m=void 0===f||f,v=e.maskAllInputs,g=e.maskInputOptions,b=e.slimDOMOptions,y=e.maskInputFn,w=e.maskTextFn,S=e.hooks,k=e.packFn,C=e.sampling,I=void 0===C?{}:C,T=e.mousemoveWait,E=e.recordCanvas,_=void 0!==E&&E,x=e.collectFonts,N=void 0!==x&&x,O=e.recordLog,M=void 0!==O&&O;if(!t)throw new Error("emit function is required");void 0!==T&&void 0===I.mousemove&&(I.mousemove=T);var L,D,R=!0===v?{color:!0,date:!0,"datetime-local":!0,email:!0,month:!0,number:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0,textarea:!0,select:!0,password:!0}:void 0!==g?g:{password:!0},P=!0===b||"all"===b?{script:!0,comment:!0,headFavicon:!0,headWhitespace:!0,headMetaSocial:!0,headMetaRobots:!0,headMetaHttpEquiv:!0,headMetaVerification:!0,headMetaAuthorship:"all"===b,headMetaDescKeywords:"all"===b}:b||{},A={level:["assert","clear","count","countReset","debug","dir","dirxml","error","group","groupCollapsed","groupEnd","info","log","table","time","timeEnd","timeLog","trace","warn"],lengthThreshold:1e3,logger:console},F=M?!0===M?A:Object.assign({},A,M):{};void 0===L&&(L=window),"NodeList"in L&&!L.NodeList.prototype.forEach&&(L.NodeList.prototype.forEach=Array.prototype.forEach),"DOMTokenList"in L&&!L.DOMTokenList.prototype.forEach&&(L.DOMTokenList.prototype.forEach=Array.prototype.forEach),Node.prototype.contains||(Node.prototype.contains=function(e){if(!(0 in arguments))throw new TypeError("1 argument is required");do{if(this===e)return!0}while(e=e&&e.parentNode);return!1});var V=0;lt=function(e,i){var o;if(!(null===(o=nt[0])||void 0===o?void 0:o.isFrozen())||e.type===ke.FullSnapshot||e.type===ke.IncrementalSnapshot&&e.data.source===Ce.Mutation||nt.forEach((function(e){return e.unfreeze()})),t(k?k(e):e,i),e.type===ke.FullSnapshot)D=e,V=0;else if(e.type===ke.IncrementalSnapshot){if(e.data.source===Ce.Mutation&&e.data.isAttachIframe)return;V++;var a=r&&V>=r,s=n&&e.timestamp-D.timestamp>n;(a||s)&&dt(!0)}};var j=function(e){lt(ft({type:ke.IncrementalSnapshot,data:Z({source:Ce.Mutation},e)}))},$=function(e){return lt(ft({type:ke.IncrementalSnapshot,data:Z({source:Ce.Scroll},e)}))},z=new pt({mutationCb:j}),q=new ht({mutationCb:j,scrollCb:$,bypassOptions:{blockClass:o,blockSelector:s,maskTextClass:d,maskTextSelector:h,inlineStylesheet:m,maskInputOptions:R,maskTextFn:w,recordCanvas:_,sampling:I,slimDOMOptions:P,iframeManager:z},mirror:mt});dt=function(e){var t,n,r,i;void 0===e&&(e=!1),lt(ft({type:ke.Meta,data:{href:window.location.href,width:Pe(),height:Re()}}),e),nt.forEach((function(e){return e.lock()}));var a=te(function(e,t){var n=t||{},r=n.blockClass,i=void 0===r?"rr-block":r,o=n.blockSelector,a=void 0===o?null:o,s=n.maskTextClass,c=void 0===s?"rr-mask":s,u=n.maskTextSelector,l=void 0===u?null:u,d=n.inlineStylesheet,p=void 0===d||d,h=n.recordCanvas,f=void 0!==h&&h,m=n.maskAllInputs,v=void 0!==m&&m,g=n.maskTextFn,b=n.maskInputFn,y=n.slimDOM,w=void 0!==y&&y,S=n.preserveWhiteSpace,k=n.onSerialize,C=n.onIframeLoad,I=n.iframeLoadTimeout,T=n.keepIframeSrcFn,E={};return[Se(e,{doc:e,map:E,blockClass:i,blockSelector:a,maskTextClass:c,maskTextSelector:l,skipChild:!1,inlineStylesheet:p,maskInputOptions:!0===v?{color:!0,date:!0,"datetime-local":!0,email:!0,month:!0,number:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0,textarea:!0,select:!0,password:!0}:!1===v?{password:!0}:v,maskTextFn:g,maskInputFn:b,slimDOMOptions:!0===w||"all"===w?{script:!0,comment:!0,headFavicon:!0,headWhitespace:!0,headMetaDescKeywords:"all"===w,headMetaSocial:!0,headMetaRobots:!0,headMetaHttpEquiv:!0,headMetaAuthorship:!0,headMetaVerification:!0}:!1===w?{}:w,recordCanvas:f,preserveWhiteSpace:S,onSerialize:k,onIframeLoad:C,iframeLoadTimeout:I,keepIframeSrcFn:void 0===T?function(){return!1}:T}),E]}(document,{blockClass:o,blockSelector:s,maskTextClass:d,maskTextSelector:h,inlineStylesheet:m,maskAllInputs:R,maskTextFn:w,slimDOM:P,recordCanvas:_,onSerialize:function(e){je(e)&&z.addIframe(e),$e(e)&&q.addShadowRoot(e.shadowRoot,document)},onIframeLoad:function(e,t){z.attachIframe(e,t)}}),2),c=a[0],u=a[1];if(!c)return console.warn("Failed to snapshot the document");mt.map=u,lt(ft({type:ke.FullSnapshot,data:{node:c,initialOffset:{left:void 0!==window.pageXOffset?window.pageXOffset:(null===document||void 0===document?void 0:document.documentElement.scrollLeft)||(null===(n=null===(t=null===document||void 0===document?void 0:document.body)||void 0===t?void 0:t.parentElement)||void 0===n?void 0:n.scrollLeft)||(null===document||void 0===document?void 0:document.body.scrollLeft)||0,top:void 0!==window.pageYOffset?window.pageYOffset:(null===document||void 0===document?void 0:document.documentElement.scrollTop)||(null===(i=null===(r=null===document||void 0===document?void 0:document.body)||void 0===r?void 0:r.parentElement)||void 0===i?void 0:i.scrollTop)||(null===document||void 0===document?void 0:document.body.scrollTop)||0}}})),nt.forEach((function(e){return e.unlock()}))};try{var U=[];U.push(xe("DOMContentLoaded",(function(){lt(ft({type:ke.DomContentLoaded,data:{}}))})));var B=function(e){return ut({mutationCb:j,mousemoveCb:function(e,t){return lt(ft({type:ke.IncrementalSnapshot,data:{source:t,positions:e}}))},mouseInteractionCb:function(e){return lt(ft({type:ke.IncrementalSnapshot,data:Z({source:Ce.MouseInteraction},e)}))},scrollCb:$,viewportResizeCb:function(e){return lt(ft({type:ke.IncrementalSnapshot,data:Z({source:Ce.ViewportResize},e)}))},inputCb:function(e){return lt(ft({type:ke.IncrementalSnapshot,data:Z({source:Ce.Input},e)}))},mediaInteractionCb:function(e){return lt(ft({type:ke.IncrementalSnapshot,data:Z({source:Ce.MediaInteraction},e)}))},styleSheetRuleCb:function(e){return lt(ft({type:ke.IncrementalSnapshot,data:Z({source:Ce.StyleSheetRule},e)}))},canvasMutationCb:function(e){return lt(ft({type:ke.IncrementalSnapshot,data:Z({source:Ce.CanvasMutation},e)}))},fontCb:function(e){return lt(ft({type:ke.IncrementalSnapshot,data:Z({source:Ce.Font},e)}))},logCb:function(e){return lt(ft({type:ke.IncrementalSnapshot,data:Z({source:Ce.Log},e)}))},blockClass:o,ignoreClass:u,maskTextClass:d,maskTextSelector:h,maskInputOptions:R,inlineStylesheet:m,sampling:I,recordCanvas:_,collectFonts:N,doc:e,maskInputFn:y,maskTextFn:w,logOptions:F,blockSelector:s,slimDOMOptions:P,mirror:mt,iframeManager:z,shadowDomManager:q},S)};z.addLoadListener((function(e){(function(e){var t=null;try{t=e.contentDocument.body.innerHTML}catch(e){}return null!==t})(e)&&U.push(B(e.contentDocument))}));var H=function(){dt(),U.push(B(document))};return"interactive"===document.readyState||"complete"===document.readyState?H():U.push(xe("load",(function(){lt(ft({type:ke.Load,data:{}})),H()}),window)),function(){U.forEach((function(e){return e()}))}}catch(e){console.warn(e)}}vt.addCustomEvent=function(e,t){if(!lt)throw new Error("please add custom event after start recording");lt(ft({type:ke.Custom,data:{tag:e,payload:t}}))},vt.freezePage=function(){nt.forEach((function(e){return e.freeze()}))},vt.takeFullSnapshot=function(e){if(!dt)throw new Error("please take full snapshot after start recording");dt(e)},vt.mirror=mt;var gt=vt,bt=gt.addCustomEvent;gt.freezePage;class yt{constructor(){this.eventBuffer=[],this.vfCounter=0,this.didSetupRecorder=!1,this.recordStopper=null,this.firstRecordedTimestamp=null,this.lastRecordedTimestamp=null,this.invalidVideoLength=!1,this.lastFragPostTimestamp=new Date,this.pauseTimeout=!1,this.freezingEvents=!1,this.setupUnloadHandler()}static configureInstance(){this.instance||(this.instance=new yt,window.addEventListener("click",()=>{this.instance.handleFragPost()}))}static getInstance(){if(!this.instance)throw new Error("SessionRecorder was not configured");return this.instance}setupUnloadHandler(){window.addEventListener("unload",()=>{this.handleFragPost()})}recordUserSession(){if(this.didSetupRecorder)return;const e=this;e.recordStopper=gt({emit(t){e.handleNewRRwebEvent(t,f.lb)},inlineStylesheet:!1,maskAllInputs:!0,blockClass:y()}),this.didSetupRecorder=!0}handleNewRRwebEvent(e,t){if(M.getInstance().closeIfInactive())return void(this.recordStopper&&this.recordStopper());if(5===e.type&&e.data.tag===f.bc)return;3===e.type&&0===e.data.source||(this.pauseTimeout&&(clearTimeout(this.pauseTimeout),this.freezingEvents=!1),this.pauseTimeout=setTimeout((function(){yt.getInstance().freezingEvents=!0,gt.freezePage()}),t)),(!this.firstRecordedTimestamp||e.timestamp<this.firstRecordedTimestamp)&&(this.firstRecordedTimestamp=e.timestamp),(!this.lastRecordedTimestamp||e.timestamp>this.lastRecordedTimestamp)&&(this.lastRecordedTimestamp=e.timestamp),this.eventBuffer.push(e),3!==e.type||2!==e.data.source||2!==e.data.type&&4!==e.data.type||N.getInstance().addVideoClick();const n=new Date;n.setMilliseconds(n.getMilliseconds()-f.mb),(this.eventBuffer.length>=f.jb||this.lastFragPostTimestamp<n)&&this.handleFragPost()}handleFragPost(){if(!M.getInstance().closeIfInactive()&&this.didSetupRecorder&&0!==this.eventBuffer.length){try{let e=0;this.firstRecordedTimestamp&&this.lastRecordedTimestamp&&!this.invalidVideoLength&&(e=this.lastRecordedTimestamp-this.firstRecordedTimestamp),!this.invalidVideoLength&&(e<0||e>=Number.MAX_SAFE_INTEGER)&&(x.getInstance().postNoibuErrorAndOptionallyDisableClient(`video lengthMS is invalid: ${e}, start time: ${this.firstRecordedTimestamp}, end time: `+this.lastRecordedTimestamp,!1,f.Rb),this.invalidVideoLength=!0,e=0),this.vfCounter+=1,this.eventBuffer.sort((e,t)=>e.timestamp-t.timestamp);const t={};t[f.gc]=JSON.stringify(this.eventBuffer),t[f.Kb]=this.vfCounter,t[f.Z]=e,M.getInstance().addEndTimeToPayload(t),N.getInstance().addVideoFragData(this.vfCounter,e);const n={};n[f.Bb]=t,M.getInstance().sendMessage(f.hc,n),this.lastFragPostTimestamp=new Date}catch(e){x.getInstance().postNoibuErrorAndOptionallyDisableClient("video frag socket closed with err: "+e.message,!1,f.Rb),this.recordStopper&&this.recordStopper()}this.eventBuffer=[]}}unfreeze(){this.freezingEvents&&bt(f.bc,{})}}function wt(e){if(w())return;if(function(e){for(let t=0;t<f.Nb.length;t+=1){if(!e[f.Nb[t]])return!0}return!1}(e))return;if(!window.location.href.startsWith("http"))return;const t=i()(),n=`${e.metroplexHTTPBase}/${f.nb}`;if(x.configureInstance(n),x.getInstance().isClientDisabled)return;M.getInstance(t),yt.configureInstance(),L.configureInstance();const r=yt.getInstance();O.getInstance();const o=new Y,a=X.getInstance();$(),B(),a.monitorClicks(),setInterval((function(){if(G!==window.location.href){G=window.location.href;const e={[f.cc]:v()};D.getInstance().addEvent(e,f.ab)}}),1e3),o.monitor(),r.recordUserSession()}wt({metroplexSocketBase:Object(f.z)(),metroplexHTTPBase:Object(f.y)()})}]);